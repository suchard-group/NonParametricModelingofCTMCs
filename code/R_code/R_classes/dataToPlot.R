library(R6)
# ---- DataToPlot ----
DataToPlot <- 
  R6Class("DataToPlot",
           public = list(
             data = NULL,
             path = NULL,
             jobName = NULL,
             attributes = list(),
             plottingFlags = list(),
             actions = list(),
             gridResults = NULL,
             path_to_job = NULL,
             
             initialize = function(data, path, jobName = NULL, attributes = list(),
                                   plottingFlags = list(), actions = list(), gridResults = NULL) {
               self$data <- data
               self$path <- path
               self$jobName <- jobName
               self$attributes <- attributes
               self$plottingFlags <- plottingFlags
               self$actions <- actions
  
               if (!is.null(self$jobName)) {
                 self$path_to_job <- file.path(self$path, self$jobName)
               } else {
                 self$jobName <- "Job1"  # Default job name
                 self$path_to_job <- dirname(self$path)
               }
               
               if (is.null(gridResults)) {
                 stop("gridResults must be provided.")
               } else {
                 self$gridResults <- gridResults
               }
             },
             
             plotCreator = function() {
               stop("This method should be implemented in a subclass.")
             },
             
             getPredictor = function() {
               inputs <- self$inputs
               return(inputs$predictor)
             },
             
             inputsSetter = function() { # add more general details?
               stop("This
                    method should be implemented in a subclass.")
             }, 
             
             getInputtxt = function() {
               inputFilePath <- file.path(self$path_to_job, "inputs.txt")
               if (file.exists(inputFilePath)) { 
                 cat("input.txt found \n")
                 inputFile <- readLines(inputFilePath)
                 return(inputFile)
               } else {
                 cat("input.txt not found \n")
                 return(NULL)
               }
             },
             
             strToNum = function(str) {
               a <- as.numeric(strsplit(str, " ")[[1]])
               # cat(length(a), "\n")
               return(a)
             }, 
             
             summStatCalculator = function(data) {
               summStat <- sapply(data, function(x) {
                 hdi <- hdi(x, credMass = 0.95) |> unname() #  Compute the 95% highest density interval
                 quantiles <- quantile(x, c(0.25, 0.5, 0.75)) |> unname()
                 c(mean = mean(x),
                   sd = sd(x),
                   q05 = hdi[1],
                   q25 = quantiles[1],
                   median = quantiles[2],
                   q75 = quantiles[3],
                   q95 = hdi[2])
               }) |> t()
               
               # summStat <- sapply(data, function(x) { 
               #   quantiles <- quantile(x, c(0.05, 0.25, 0.5, 0.75, 0.95)) |> unname()
               #   c(mean = mean(x),
               #     sd = sd(x),
               #     q05 = quantiles[1],
               #     q25 = quantiles[2],
               #     median = quantiles[3],
               #     q75 = quantiles[4],
               #     q95 = quantiles[5]) }) |> t()  #quantile(x, probs = c(0.25, 0.5, 0.75)))) |> t()
               return(summStat)
             }
           )
)
# ---- DataToPlotNPRates ----
DataToPlotNPRates <- 
  R6Class("DataToPlotNPRates",
          inherit = DataToPlot,
          public = list(
            summStat = NULL, 
            otherData = NULL,
            inputs = NULL, 
            initialize = function(data, path, jobName = NULL, attributes = list(),
                                  plottingFlags = list(), actions = list(), gridResults = NULL) {
              defaultsPlotting <- list(
                plottingLogRates = FALSE,
                plottingRatesLogRates = FALSE,
                plottingHyperpar = FALSE, 
                plottingDerivatives = FALSE
              )
              plottingFlags <- modifyList(defaultsPlotting, plottingFlags)
              defaultsActions <- list(
                normalize = FALSE,
                exponentiate = FALSE,
                simulation = "off", 
                publicationQuality = FALSE,
                useInput = TRUE, 
                centerData = FALSE, 
                addClockRate = FALSE
              )
              actions <- modifyList(defaultsActions, actions)
              super$initialize(data = data, path = path, jobName = jobName, attributes = attributes, 
                              plottingFlags = plottingFlags, actions = actions, gridResults = gridResults)
              # cat("HERE", self$attributes$dataType, "\n")
              self$summStat = NULL
              self$otherData = NULL
              self$inputs = NULL
                self$preProcessData()
                self$morePreProcessing()
              },
            
            preProcessData = function() {
              cat("The data has ", nrow(self$data), " rows and ", ncol(self$data), " columns. \n")
              
              self$data <- self$data %>%
                rename_with(~ str_replace(., "host\\.model", "logRates"))
              
              self$data <- self$data |>
                rename_with(~ gsub("loc.model", "logRates", .), everything())
              self$data <- self$data |>
                rename_with(~ gsub("originModel", "logRates", .), everything())
              
              self$data <- self$data |>
                rename_with(~ gsub("host\\.model", "logRates", .x), starts_with("host.model"))
              
              #print( colnames(self$data) )
              if (self$actions$normalize) {
                # self$data <- normalizeRates(self$data)
              }
              
              if (self$actions$exponentiate) {
                self$data <-  self$data |> 
                  mutate(across(contains("logRates"), exp))
              }
              # self$data <- self$data %>%
              #   mutate(across(starts_with("logRates"), exp, .names = "rates{.col}")) %>%
              #   rename_with(~ gsub("logRates", "rates", .), starts_with("rateslogRates"))
            
              
              
              if (self$actions$addClockRate) {
                if (self$actions$simulation == "on") {
                  self$data <- self$data |>
                    mutate(across(starts_with("logRate"), ~ .x + log(clock.rate)))
                } else {
                  if (self$attributes$tree == "rabies") {
                    self$data <- self$data |>
                      mutate(across(starts_with("logRate"), ~ .x + log(host.clock.rate)))
                  } else {
                    self$data <- self$data |>
                      mutate(across(starts_with("logRate"), ~ .x + log(geo.clock.rate)))
                  }
                }
                
              }
              if (self$actions$centerData) {
                self$data <- self$data |> mutate(referenceDistance =  logRates.1.2  + 3) |>
                  mutate(across(starts_with("logRates"), ~ .x - referenceDistance))
              }
            },
            
            morePreProcessing = function() {
              summStat <- self$summStatCalculator(self$data)
              
              self$inputs <- self$inputsSetter()
              predictor <- self$inputs$predictor
              
              summaryLogRates <- summStat |> row.names() |> 
                sapply(function(x) 
                  grepl("logRates", x)) %>% 
                  summStat[.,] |> as_tibble() 

                cat("Stats and predictor lengths are ", length(summaryLogRates$median), "and", length(predictor), "\n")

                summaryLogRatesPred <- cbind(predictor, summaryLogRates) |> as_tibble()
                lmod <- lm(median ~ predictor, summaryLogRatesPred)
                
            
                
                slope <- coef(lmod)[2] %>% round(4) %>% as.character()
                slope <- paste0("\nSlopes\nTrue: 1\n", "Est: ", slope)
                ytextSlope <- Inf
                ymin <- min(summaryLogRates$q05)
                ymax <- max(summaryLogRates$q95)
                if (self$attributes$predictorName == "Body size") {
                  trueLine <- -0.14581 * predictor - 2.8
                } else if (self$attributes$predictorName == "Host genetic distance") {
                  # trueLine <- -0.6171 * spredictor - 3.1
                  trueLine <- self$normalizeRates(-0.5694 * predictor) #+ log(0.007693286)
                  # - 3.1
                } else if (self$attributes$predictorName == "Range overlap") {
                  trueLine <- self$normalizeRates(0.428 * predictor) 
                  # normalizeRates(0.2957 * redictor - 2.8)
                } else if (self$attributes$predictorName == "SmallHost") {
                  trueLine <- self$normalizeRates(predictor^2)
                  # as.numeric(strsplit(predictor, " ")[[1]]) "0 -0.6931472 -1.098612 -1.098612 -0.6931472 0 0 -0.6931472 -1.098612 -1.098612 -0.6931472 0 -0.6931472 -1.098612 -1.098612 0 -0.6931472 -1.098612 0 -0.6931472 0 0 -0.6931472 -1.098612 -1.098612 -0.6931472 0 0 -0.6931472 -1.098612 -1.098612 -0.6931472 0 -0.6931472 -1.098612 -1.098612 0 -0.6931472 -1.098612 0 -0.6931472 0"
                } else if (self$attributes$predictorName == "Total seats") {
                  cat("Choosing slope for total seats \n")
                  trueLine <-  
                    self$normalizeRates(1.3113*predictor) #1.3113*predictor - 3
                } else if (self$attributes$predictorName == "Origin population density") {
                  cat("Choosing slope for donor population density \n")
                  trueLine <-  
                    self$normalizeRates(0.30716*predictor) #0.30716*predictor - 3
                } else {
                  cat("Choosing default slope \n")
                  trueLine <-  self$normalizeRates(0.5*predictor)
                }
                
                
                if (!is.null(self$attributes$shape) && nzchar(self$attributes$shape)) {
                  cat("Choosing shape \n")
                  if (self$attributes$shape == "Concave") {
                    trueLine <- self$normalizeRates(- 0.3 * predictor^2 - 1.7 * predictor - 1)
                  } else if  (self$attributes$shape == "Convex") {
                    trueLine <- self$normalizeRates(0.2 * predictor^2 + 0.3 * predictor - 3.5) #+ log(0.2)
                  }
                }
                
                # cat("trueLine is ", trueLine, "\n")
                # cat("predictor is ", predictor, "\n")
                # cat("medians are ", summaryLogRatesPred$median, "\n")
                
                
                self$summStat <- summaryLogRatesPred
                # self$dataRates <- summaryRatesPred
                self$otherData <- list(slope = slope, ytextSlope = ytextSlope, 
                                   ymin = ymin, ymax = ymax, 
                                   trueLine = trueLine)

            },
            
            plotCreator = function() {
            
              summStat <- self$summStat
              otherData <- self$otherData
                # self$summStatCalculator(self$data)

              inputs <- self$inputs
              # if (self$attributes$norm == "normOn") {
              #   inputs$predictor <- self$normalizeRates(inputs$predictor)
              # }
              # summarizing hyperparameters
              if (self$plottingFlags$plottingHyperpar) {
                self$gridResults$hyperparameters[[self$jobName]] <- boxPlotHyper(self$data, self$jobName)
              }
              if (self$plottingFlags$plottingLogRates) {
                if (startsWith(self$jobName, "Glm_Glm")) {
                  # TODO or to delete case
                  #gridResults$logRatesQuantiles[[jobName]] <- boxPlotGlmCoefficients(data, jobName) # TODO(?)
                } else { 
                  if ( self$attributes$dataType == "Alph" ) {
                    print("Plotting from Alphabet")
                    self$gridResults$logRatesQuantiles[[self$jobName]] <- 
                      plottingLogRates$new(summStat, otherData, inputs$predictor, self$attributes$predictorName, self$jobName, 
                                             attributes = self$attributes, actions=self$actions)$plottingSimulation()
                    
                      # plotLogRatesQuantiles(summStat, inputs$logRates, inputs$predictor, self$jobName)
                    self$gridResults$logRatesBoxPlots[[self$jobName]] <- boxPlotLogRates(self$data, inputs$logRates, inputs$predictor, self$jobName)
                  } else if ( self$attributes$dataType == "RealData" ) {
                    print("Plotting from Real Data")
                    self$gridResults$logRatesQuantiles[[self$jobName]] <- 
                      plottingLogRates$new(summStat, otherData, inputs$predictor, self$attributes$predictorName, 
                                             self$jobName, attributes = self$attributes, actions=self$actions)$plotting()
                    # self$gridResults$plottingRatesLogRates[[self$jobName]] <- 
                    #  plottingLogRates$new(summStat, inputs$predictor, self$attributes$predictorName, self$jobName, attributes = self$attributes, actions=self$actions)$plottingFull()
                    } else {
                    stop("Data type not recognized")
                  }
                }
                if (self$plottingFlags$plottingDerivatives) {
                  self$gridResults$plottingDerivatives[[self$jobName]] <- 
                    plottingLogRates$new(summStat, otherData, inputs$predictor, self$attributes$predictorName, 
                                           self$jobName, attributes = self$attributes, actions=self$actions)$plottingDerivatives()
                }
                
              }
              cat("Plotting completed \n")
              return(self$gridResults)
            },
            
            inputsSetter = function() { 
              var_names <- c("rates", "logRates", "predictor")
              inputs <- setNames(vector("list", length(var_names)), var_names)
              inputFilePath <- file.path(self$path_to_job, "inputs.txt")
              if (file.exists(inputFilePath) && self$actions$useInput) { 
                cat("input.txt found \n")
                inputFile <- readLines(inputFilePath)
                for (var in var_names) {
                  ## TODO ADD FUNCTION EXTRACT VECTOR??? OK IF IT IS IN OPEN DATA
                  inputs[[var]] <- extract_vector(inputFile, var)
                }
              } else {
                cat("input.txt not found; loading from attributes \n")
                inputs$predictor <- self$loadPredictor()
                if (length(self$attributes$predictorFun) > 0) {
                  if ( self$attributes$predictorFun == "Equal" ) {
                    inputs$logRates <- inputs$predictor
                  } else if ( self$attributes$predictorFun == "Exp" ) {
                    inputs$logRates <- exp(inputs$predictor)
                  } else {
                    stop("Predictor function not recognized")
                  }
                }
              }
                
              return(inputs)
            }, 
          
            normalizeRates = function(logRates) {
              n_rates <- length(logRates)
              n_states <- 0.5 * (1 + sqrt(1 + 4 * n_rates))
              Q <- exp(logRates) |> getQ()
              normalizationConstant <- - sum(diag(Q)) / n_states
              # cat("The normalization constant is: ", normalizationConstant, "\n")
              logRates <- logRates - log(normalizationConstant)
              return(logRates)
            }, 
          
            loadPredictor = function() {
              if (self$attributes$dataType == "Alph") {
                cat("Loading from Alphabet\n")
                cat(self$attributes$predictorName)
                if ( typeof(self$attributes$nstates) == "character" ) self$attributes$nstates <- self$attributes$nstates %>% as.numeric()
                if ( self$attributes$predictorName == "SmallHost") {
                  predictor = "0.1328272 0.5853719 0.3290598 0.000258102 0.528304 0.00413567 0.7021011 0.2874215 0.3083193 0.02728716 0.0993425 0.2593089 0.1142748 -0.4819359 -0.1594975 0.7230747 0.8627461 0.6320418 0.3393718 0.8111955 -0.5285531 0.968507 0.5947693 0.6134686 0.363284 0.4271614 0.5696379 -0.3954792 -0.08245753 0.1985998 0.9875541 0 -0.7233346 -0.0546088 0.7645487 0 -0.3554541 0.785054 0.5506378 0.6103608 0.7438897 0.848523"
                  if (self$attributes$nstates == 5)  predictor <- as.numeric(strsplit(predictor, " ")[[1]])[1:20]
                  if (self$attributes$nstates == 7)  predictor <- as.numeric(strsplit(predictor, " ")[[1]])[1:42]
                  if (self$attributes$nstates == 17) {

                    }
                } else if (self$attributes$predictorName == "HostDistance") {
                  # predictor <- "0.132827181 0.585371903 0.329059784 0.000258102 0.528304033 0.00413567 0.702101107 0.287421539 0.308319324 0.027287162 0.099342498 0.259308933 0.114274846 -0.481935854 -0.159497456 0.72307465 0.862746109 0.632041762 0.339371754 0.811195534 -0.528553065 0.968507009 0.594769336 0.61346858 0.363283968 0.427161408 0.569637929 -0.395479185 -0.082457532 0.198599809 0.987554077 -2.229986347 -0.723334615 -0.054608804 0.764548724 -4.943831267 -0.355454102 0.785053954 0.550637774 0.61036084 0.74388973 0.848522993 0.136522703 0.397088214 0.460195514 -1.1480215 -0.382072777 0.525098668 -1.917141852 -0.723334615 0.547458303 0.29091553 0.356473059 0.502556075 0.616572819 -0.16773367 0.121710778 0.191368803 -0.24298904 0.220179643 -0.537971916 -0.566423234 0.245144319 -0.042759274 0.0311269 0.194986678 0.322163631 -0.566423234 -0.234525097 -0.155388564 0.711109326 0.091845863 -1.893892672 0.732014663 0.492838212 0.553813581 0.690044145 0.796703068 0.069232783 0.335938717 0.400445937 0.874071968 0.48634054 0.505787761 0.245144319 0.311786928 0.460195514 -0.800080843 -0.221877738 0.073014543 0.893780872 -0.192591084 0.893780872 0.668816654 0.726057879 0.854221054 0.954820883 0.273401094 0.521889568 0.582232289 0.50901566 0.248692306 0.315250174 0.463477244 0.579089092 -0.217674821 0.076791119 0.14757962 -2.632963022 -2.447600324 -3.54585572 0.597894704 -0.575972677 -0.24298904 0.913349782 -4.492589849 -2.77799711 0.346225019 -0.971321129 -0.590359192 0.690044145 -2.582961442 0.410494622 -0.868368703 -0.500488189 0.746850517 0.553813581 -0.643761967 -0.302976107 0.874071968 -0.102523254 0.180486585 0.973962479 -1.355814827 0.297890246 0.544275159 0.132827181 0.585371903 0.329059784 0.000258102 0.528304033 0.00413567 0.702101107 0.287421539 0.308319324 0.027287162 0.099342498 0.259308933 0.114274846 -0.481935854 -0.159497456 0.72307465 0.862746109 0.632041762 0.339371754 0.811195534 -0.528553065 0.968507009 0.594769336 0.61346858 0.363283968 0.427161408 0.569637929 -0.395479185 -0.082457532 0.198599809 0.987554077 -2.229986347 -0.723334615 -0.054608804 0.764548724 -4.943831267 -0.355454102 0.785053954 0.550637774 0.61036084 0.74388973 0.848522993 0.136522703 0.397088214 0.460195514 -1.1480215 -0.382072777 0.525098668 -1.917141852 -0.723334615 0.547458303 0.29091553 0.356473059 0.502556075 0.616572819 -0.16773367 0.121710778 0.191368803 -0.24298904 0.220179643 -0.537971916 -0.566423234 0.245144319 -0.042759274 0.0311269 0.194986678 0.322163631 -0.566423234 -0.234525097 -0.155388564 0.711109326 0.091845863 -1.893892672 0.732014663 0.492838212 0.553813581 0.690044145 0.796703068 0.069232783 0.335938717 0.400445937 0.874071968 0.48634054 0.505787761 0.245144319 0.311786928 0.460195514 -0.800080843 -0.221877738 0.073014543 0.893780872 -0.192591084 0.893780872 0.668816654 0.726057879 0.854221054 0.954820883 0.273401094 0.521889568 0.582232289 0.50901566 0.248692306 0.315250174 0.463477244 0.579089092 -0.217674821 0.076791119 0.14757962 -2.632963022 -2.447600324 -3.54585572 0.597894704 -0.575972677 -0.24298904 0.913349782 -4.492589849 -2.77799711 0.346225019 -0.971321129 -0.590359192 0.690044145 -2.582961442 0.410494622 -0.868368703 -0.500488189 0.746850517 0.553813581 -0.643761967 -0.302976107 0.874071968 -0.102523254 0.180486585 0.973962479 -1.355814827 0.297890246 0.544275159"
                  predictor <- "0.1330729301599102 0.5864549232257497 0.32966859043837854 2.585794287635929E-4 0.5292814697468534 0.004143321225103507 0.7034000922550243 0.2879533088826709 0.30888975761753973 0.027337647555074306 0.09952629530226544 0.2597886911241426 0.11448627008637044 -0.4828275027738522 -0.15979254856104821 0.7244124396688911 0.8643423101713874 0.6332111275364383 0.3399996390213292 0.8126963598716884 -0.5295309620909956 0.9702988825016736 0.5958697427829477 0.6146035834170713 0.3639560946040993 0.42795171699111795 0.5706918387447398 -0.3962108769793469 -0.08261009016456665 0.19896724625063783 0.9893811907410366 -2.2341121349831057 -0.7246728857159753 -0.05470983796255145 0.7659632461481133 -4.952978049016043 -0.35611174180961996 0.7865064139593599 0.5516565316376295 0.6114900934189428 0.7452660306482283 0.8500928795000144 0.13677528965624972 0.3978228825750161 0.4610469407291312 -1.150145501363983 -0.3827796651193414 0.5260701737584673 -1.9206888332534708 -0.7246728857159753 0.5484711780346202 0.2914537641275834 0.35713258410616305 0.5034858745991059 0.6177135652567126 -0.16804400041854886 0.121935960413656 0.191722862588758 -0.24343860404619955 0.22058700632508127 -0.5389672399681408 -0.5674711964664754 0.24559787019499832 -0.042838384862891335 0.031184489419119343 0.19534743118667336 0.3227596792197974 -0.5674711964664754 -0.23495900109202666 -0.15567605474705173 0.7124249785212807 0.09201579110164597 -1.8973966394085298 0.7333689924411966 0.4937500317332618 0.5548382133624731 0.691320823126153 0.7981770807794666 0.06936087383838746 0.3365602509243595 0.40118681789777005 0.875689124057905 0.4872403386434366 0.5067235390063222 0.24559787019499832 0.3123637776994112 0.4610469407291312 -0.8015611051493662 -0.22228824315198434 0.07314963022007819 0.8954344920021259 -0.1929474047655902 0.8954344920021259 0.6700540584366876 0.727401187758072 0.8558014825497923 0.9565874355723072 0.2739069244166101 0.5228551371798494 0.5833094999899943 0.5099574100155907 0.24915242135035714 0.3158334306901483 0.4643347417023649 0.5801604881359642 -0.21807755035874613 0.07693319296562205 0.14785266341735692 -2.637834373374443 -2.4521287276266084 -3.5524160509003253 0.5990008929663515 -0.5770383068794052 -0.24343860404619955 0.9150396075445031 -4.500901771110683 -2.7831367944122154 0.3468655843296725 -0.9731182090561851 -0.5914514393217515 0.691320823126153 -2.5877402834522147 0.4112540944350217 -0.8699753067537476 -0.5014141628473923 0.748232294867805 0.5548382133624731 -0.644953016654826 -0.3035366552343514 0.875689124057905 -0.10271293642821007 0.18082051033334226 0.9757644458533032 -1.3583232742959948 0.298441384544917 0.5452821440684552 0.1330729301599102 0.5864549232257497 0.32966859043837854 2.585794287635929E-4 0.5292814697468534 0.004143321225103507 0.7034000922550243 0.2879533088826709 0.30888975761753973 0.027337647555074306 0.09952629530226544 0.2597886911241426 0.11448627008637044 -0.4828275027738522 -0.15979254856104821 0.7244124396688911 0.8643423101713874 0.6332111275364383 0.3399996390213292 0.8126963598716884 -0.5295309620909956 0.9702988825016736 0.5958697427829477 0.6146035834170713 0.3639560946040993 0.42795171699111795 0.5706918387447398 -0.3962108769793469 -0.08261009016456665 0.19896724625063783 0.9893811907410366 -2.2341121349831057 -0.7246728857159753 -0.05470983796255145 0.7659632461481133 -4.952978049016043 -0.35611174180961996 0.7865064139593599 0.5516565316376295 0.6114900934189428 0.7452660306482283 0.8500928795000144 0.13677528965624972 0.3978228825750161 0.4610469407291312 -1.150145501363983 -0.3827796651193414 0.5260701737584673 -1.9206888332534708 -0.7246728857159753 0.5484711780346202 0.2914537641275834 0.35713258410616305 0.5034858745991059 0.6177135652567126 -0.16804400041854886 0.121935960413656 0.191722862588758 -0.24343860404619955 0.22058700632508127 -0.5389672399681408 -0.5674711964664754 0.24559787019499832 -0.042838384862891335 0.031184489419119343 0.19534743118667336 0.3227596792197974 -0.5674711964664754 -0.23495900109202666 -0.15567605474705173 0.7124249785212807 0.09201579110164597 -1.8973966394085298 0.7333689924411966 0.4937500317332618 0.5548382133624731 0.691320823126153 0.7981770807794666 0.06936087383838746 0.3365602509243595 0.40118681789777005 0.875689124057905 0.4872403386434366 0.5067235390063222 0.24559787019499832 0.3123637776994112 0.4610469407291312 -0.8015611051493662 -0.22228824315198434 0.07314963022007819 0.8954344920021259 -0.1929474047655902 0.8954344920021259 0.6700540584366876 0.727401187758072 0.8558014825497923 0.9565874355723072 0.2739069244166101 0.5228551371798494 0.5833094999899943 0.5099574100155907 0.24915242135035714 0.3158334306901483 0.4643347417023649 0.5801604881359642 -0.21807755035874613 0.07693319296562205 0.14785266341735692 -2.637834373374443 -2.4521287276266084 -3.5524160509003253 0.5990008929663515 -0.5770383068794052 -0.24343860404619955 0.9150396075445031 -4.500901771110683 -2.7831367944122154 0.3468655843296725 -0.9731182090561851 -0.5914514393217515 0.691320823126153 -2.5877402834522147 0.4112540944350217 -0.8699753067537476 -0.5014141628473923 0.748232294867805 0.5548382133624731 -0.644953016654826 -0.3035366552343514 0.875689124057905 -0.10271293642821007 0.18082051033334226 0.9757644458533032 -1.3583232742959948 0.298441384544917 0.5452821440684552"
                  self$attributes$predictorName <- "Host genetic distance" 
                  predictor <- as.numeric(strsplit(predictor, " ")[[1]])
                } else {
                  rates <- computeRatesAlph(self$attributes$nstates, self$attributes$predictorName)
                  if (self$attributes$predictorFun == "Equal")  predictor <- log(rates)
                  if (self$attributes$predictorFun == "Exp")  predictor <- rates
                }
              } else if (self$attributes$dataType == "RealData") {
                cat("Loading from Real Data\n")
                if (self$attributes$tree == "rabies") {
                  cat("Loading predictors from rabies dataset... \n")
                  
                  # self$attributes$predictorName = "RangeOverlap"
                  
                  
                  if (self$attributes$predictorName == "HostDistance") {
                    # predictor <- "0.132827181 0.585371903 0.329059784 0.000258102 0.528304033 0.00413567 0.702101107 0.287421539 0.308319324 0.027287162 0.099342498 0.259308933 0.114274846 -0.481935854 -0.159497456 0.72307465 0.862746109 0.632041762 0.339371754 0.811195534 -0.528553065 0.968507009 0.594769336 0.61346858 0.363283968 0.427161408 0.569637929 -0.395479185 -0.082457532 0.198599809 0.987554077 -2.229986347 -0.723334615 -0.054608804 0.764548724 -4.943831267 -0.355454102 0.785053954 0.550637774 0.61036084 0.74388973 0.848522993 0.136522703 0.397088214 0.460195514 -1.1480215 -0.382072777 0.525098668 -1.917141852 -0.723334615 0.547458303 0.29091553 0.356473059 0.502556075 0.616572819 -0.16773367 0.121710778 0.191368803 -0.24298904 0.220179643 -0.537971916 -0.566423234 0.245144319 -0.042759274 0.0311269 0.194986678 0.322163631 -0.566423234 -0.234525097 -0.155388564 0.711109326 0.091845863 -1.893892672 0.732014663 0.492838212 0.553813581 0.690044145 0.796703068 0.069232783 0.335938717 0.400445937 0.874071968 0.48634054 0.505787761 0.245144319 0.311786928 0.460195514 -0.800080843 -0.221877738 0.073014543 0.893780872 -0.192591084 0.893780872 0.668816654 0.726057879 0.854221054 0.954820883 0.273401094 0.521889568 0.582232289 0.50901566 0.248692306 0.315250174 0.463477244 0.579089092 -0.217674821 0.076791119 0.14757962 -2.632963022 -2.447600324 -3.54585572 0.597894704 -0.575972677 -0.24298904 0.913349782 -4.492589849 -2.77799711 0.346225019 -0.971321129 -0.590359192 0.690044145 -2.582961442 0.410494622 -0.868368703 -0.500488189 0.746850517 0.553813581 -0.643761967 -0.302976107 0.874071968 -0.102523254 0.180486585 0.973962479 -1.355814827 0.297890246 0.544275159 0.132827181 0.585371903 0.329059784 0.000258102 0.528304033 0.00413567 0.702101107 0.287421539 0.308319324 0.027287162 0.099342498 0.259308933 0.114274846 -0.481935854 -0.159497456 0.72307465 0.862746109 0.632041762 0.339371754 0.811195534 -0.528553065 0.968507009 0.594769336 0.61346858 0.363283968 0.427161408 0.569637929 -0.395479185 -0.082457532 0.198599809 0.987554077 -2.229986347 -0.723334615 -0.054608804 0.764548724 -4.943831267 -0.355454102 0.785053954 0.550637774 0.61036084 0.74388973 0.848522993 0.136522703 0.397088214 0.460195514 -1.1480215 -0.382072777 0.525098668 -1.917141852 -0.723334615 0.547458303 0.29091553 0.356473059 0.502556075 0.616572819 -0.16773367 0.121710778 0.191368803 -0.24298904 0.220179643 -0.537971916 -0.566423234 0.245144319 -0.042759274 0.0311269 0.194986678 0.322163631 -0.566423234 -0.234525097 -0.155388564 0.711109326 0.091845863 -1.893892672 0.732014663 0.492838212 0.553813581 0.690044145 0.796703068 0.069232783 0.335938717 0.400445937 0.874071968 0.48634054 0.505787761 0.245144319 0.311786928 0.460195514 -0.800080843 -0.221877738 0.073014543 0.893780872 -0.192591084 0.893780872 0.668816654 0.726057879 0.854221054 0.954820883 0.273401094 0.521889568 0.582232289 0.50901566 0.248692306 0.315250174 0.463477244 0.579089092 -0.217674821 0.076791119 0.14757962 -2.632963022 -2.447600324 -3.54585572 0.597894704 -0.575972677 -0.24298904 0.913349782 -4.492589849 -2.77799711 0.346225019 -0.971321129 -0.590359192 0.690044145 -2.582961442 0.410494622 -0.868368703 -0.500488189 0.746850517 0.553813581 -0.643761967 -0.302976107 0.874071968 -0.102523254 0.180486585 0.973962479 -1.355814827 0.297890246 0.544275159"
                    predictor <- "0.1330729301599102 0.5864549232257497 0.32966859043837854 2.585794287635929E-4 0.5292814697468534 0.004143321225103507 0.7034000922550243 0.2879533088826709 0.30888975761753973 0.027337647555074306 0.09952629530226544 0.2597886911241426 0.11448627008637044 -0.4828275027738522 -0.15979254856104821 0.7244124396688911 0.8643423101713874 0.6332111275364383 0.3399996390213292 0.8126963598716884 -0.5295309620909956 0.9702988825016736 0.5958697427829477 0.6146035834170713 0.3639560946040993 0.42795171699111795 0.5706918387447398 -0.3962108769793469 -0.08261009016456665 0.19896724625063783 0.9893811907410366 -2.2341121349831057 -0.7246728857159753 -0.05470983796255145 0.7659632461481133 -4.952978049016043 -0.35611174180961996 0.7865064139593599 0.5516565316376295 0.6114900934189428 0.7452660306482283 0.8500928795000144 0.13677528965624972 0.3978228825750161 0.4610469407291312 -1.150145501363983 -0.3827796651193414 0.5260701737584673 -1.9206888332534708 -0.7246728857159753 0.5484711780346202 0.2914537641275834 0.35713258410616305 0.5034858745991059 0.6177135652567126 -0.16804400041854886 0.121935960413656 0.191722862588758 -0.24343860404619955 0.22058700632508127 -0.5389672399681408 -0.5674711964664754 0.24559787019499832 -0.042838384862891335 0.031184489419119343 0.19534743118667336 0.3227596792197974 -0.5674711964664754 -0.23495900109202666 -0.15567605474705173 0.7124249785212807 0.09201579110164597 -1.8973966394085298 0.7333689924411966 0.4937500317332618 0.5548382133624731 0.691320823126153 0.7981770807794666 0.06936087383838746 0.3365602509243595 0.40118681789777005 0.875689124057905 0.4872403386434366 0.5067235390063222 0.24559787019499832 0.3123637776994112 0.4610469407291312 -0.8015611051493662 -0.22228824315198434 0.07314963022007819 0.8954344920021259 -0.1929474047655902 0.8954344920021259 0.6700540584366876 0.727401187758072 0.8558014825497923 0.9565874355723072 0.2739069244166101 0.5228551371798494 0.5833094999899943 0.5099574100155907 0.24915242135035714 0.3158334306901483 0.4643347417023649 0.5801604881359642 -0.21807755035874613 0.07693319296562205 0.14785266341735692 -2.637834373374443 -2.4521287276266084 -3.5524160509003253 0.5990008929663515 -0.5770383068794052 -0.24343860404619955 0.9150396075445031 -4.500901771110683 -2.7831367944122154 0.3468655843296725 -0.9731182090561851 -0.5914514393217515 0.691320823126153 -2.5877402834522147 0.4112540944350217 -0.8699753067537476 -0.5014141628473923 0.748232294867805 0.5548382133624731 -0.644953016654826 -0.3035366552343514 0.875689124057905 -0.10271293642821007 0.18082051033334226 0.9757644458533032 -1.3583232742959948 0.298441384544917 0.5452821440684552 0.1330729301599102 0.5864549232257497 0.32966859043837854 2.585794287635929E-4 0.5292814697468534 0.004143321225103507 0.7034000922550243 0.2879533088826709 0.30888975761753973 0.027337647555074306 0.09952629530226544 0.2597886911241426 0.11448627008637044 -0.4828275027738522 -0.15979254856104821 0.7244124396688911 0.8643423101713874 0.6332111275364383 0.3399996390213292 0.8126963598716884 -0.5295309620909956 0.9702988825016736 0.5958697427829477 0.6146035834170713 0.3639560946040993 0.42795171699111795 0.5706918387447398 -0.3962108769793469 -0.08261009016456665 0.19896724625063783 0.9893811907410366 -2.2341121349831057 -0.7246728857159753 -0.05470983796255145 0.7659632461481133 -4.952978049016043 -0.35611174180961996 0.7865064139593599 0.5516565316376295 0.6114900934189428 0.7452660306482283 0.8500928795000144 0.13677528965624972 0.3978228825750161 0.4610469407291312 -1.150145501363983 -0.3827796651193414 0.5260701737584673 -1.9206888332534708 -0.7246728857159753 0.5484711780346202 0.2914537641275834 0.35713258410616305 0.5034858745991059 0.6177135652567126 -0.16804400041854886 0.121935960413656 0.191722862588758 -0.24343860404619955 0.22058700632508127 -0.5389672399681408 -0.5674711964664754 0.24559787019499832 -0.042838384862891335 0.031184489419119343 0.19534743118667336 0.3227596792197974 -0.5674711964664754 -0.23495900109202666 -0.15567605474705173 0.7124249785212807 0.09201579110164597 -1.8973966394085298 0.7333689924411966 0.4937500317332618 0.5548382133624731 0.691320823126153 0.7981770807794666 0.06936087383838746 0.3365602509243595 0.40118681789777005 0.875689124057905 0.4872403386434366 0.5067235390063222 0.24559787019499832 0.3123637776994112 0.4610469407291312 -0.8015611051493662 -0.22228824315198434 0.07314963022007819 0.8954344920021259 -0.1929474047655902 0.8954344920021259 0.6700540584366876 0.727401187758072 0.8558014825497923 0.9565874355723072 0.2739069244166101 0.5228551371798494 0.5833094999899943 0.5099574100155907 0.24915242135035714 0.3158334306901483 0.4643347417023649 0.5801604881359642 -0.21807755035874613 0.07693319296562205 0.14785266341735692 -2.637834373374443 -2.4521287276266084 -3.5524160509003253 0.5990008929663515 -0.5770383068794052 -0.24343860404619955 0.9150396075445031 -4.500901771110683 -2.7831367944122154 0.3468655843296725 -0.9731182090561851 -0.5914514393217515 0.691320823126153 -2.5877402834522147 0.4112540944350217 -0.8699753067537476 -0.5014141628473923 0.748232294867805 0.5548382133624731 -0.644953016654826 -0.3035366552343514 0.875689124057905 -0.10271293642821007 0.18082051033334226 0.9757644458533032 -1.3583232742959948 0.298441384544917 0.5452821440684552"
                    # predictor <- "0.8617857453290947 0.11763925837474469 0.6925555935399687 0.8610850307856458 -0.5213081646901465 0.8125411449373177 -0.786023743931082 -0.029083319976992775 -1.6760387996450654 0.7169257333564394 0.6382732111740821 0.7452569963503566 -0.4013362029605582 0.6282942278835917 -0.16783846588677617 0.7673497688688244 0.6591612434340255 0.45074915834567114 0.8590893931054254 0.008783013680845613 0.8289618895009672 -1.1074823773308233 -0.4139255674775493 0.0550257862828396 0.36105655125643366 0.7407030590383533 0.40956680757972846 0.4164069058770259 0.24345198245481484 0.5637811226399678 0.5836023230618462 -1.6760387996450654 0.8576907189989589 0.21140785627624364 0.8332739268776149 -0.904857516378091 -1.6760387996450654 0.2576506292012054 -1.6760387996450654 0.7375599060985056 -0.7767470229709207 0.6190317503241856 -0.5936559412924872 0.7631800969484168 0.5433513673407716 0.8610331655176797 -1.6760387996450654 0.8106402473124762 -1.6760387996450654 -0.0028886098734439113 -1.6760387996450654 0.6628843130503459 0.7037149688274674 0.7137514990281232 -1.6760387996450654 0.5445148794004447 -1.6760387996450654 0.6725104636127779 -0.013209765204893913 0.8312816921049386 -1.1047717063445526 -0.41123185819537267 0.05547371878915598 0.36278883437008824 0.4240902214568601 0.4118019687829002 0.4111429318684383 0.24614569091324423 0.561165831722412 0.5811217985482124 0.6497410499204633 0.8014483811757893 -0.8300971621910221 0.6787655313207953 -1.6760387996450654 0.5275905045104599 -1.6760387996450654 0.8573124574493542 -1.6760387996450654 0.8466706697238874 0.8431682604413908 0.063530390013931 -0.804816713328432 -0.02056714630710059 0.32723528935975815 0.7589953065287 -1.6760387996450654 0.3918530582524419 0.18505004582860235 0.5627045871011578 0.5432109982740396 -1.6760387996450654 0.6863001013689891 -1.6760387996450654 0.6898432798194667 -1.6760387996450654 0.8392123466394302 -1.6760387996450654 -0.4002277690089273 0.7968554048012869 -1.6760387996450654 0.8617861127170636 -0.2590097246608637 0.8617861127170636 -1.6760387996450654 0.8617861127170636 -1.6760387996450654 0.8617861127170636 -1.6760387996450654 0.7351459446363632 -1.6760387996450654 0.8617722747955313 -1.6760387996450654 0.8583261096439491 0.7656461648137879 0.7097885954547359 0.8278854301781329 -1.6760387996450654 0.66883837870321 -1.6760387996450654 0.7129173945345594 -0.5695739850563394 0.39955820098687295 0.0332981728892891 0.5833283208050997 0.41436786470989945 -1.6760387996450654 0.6482318166673172 -2.9371664590166495 0.6919386531894527 -1.6760387996450654 0.8448213901955979 0.6808187934850704 -1.0039076519149899 0.8104192036917462 0.5675472553439994 0.4769438681103487 -0.06457813964162111 0.7187503037013698 0.478936493178435 -0.05314731441070776 0.4605198542248416 -0.4636113860490779 0.8617861127170636 -1.6760387996450654 0.8328130500909449 0.3745098630756987 0.8126340561473551 -0.34079923686912433 0.8617861127170636 -0.2546757151381716 0.6604718111638693 0.8617860881020811 0.8617857453290947 0.8617831012270462 0.8617861127170636 0.8617828440533984 -0.4002277690089273 0.8617861127170636 0.8617861127170636 0.8617861127170636 0.8617819564355401 0.8617861127170636 0.861786111982288 0.8617861127170636 0.8617861127170636 0.8615666101069817 -2.542763693238067 0.6577595827042949 0.8617861127170636 0.6634700371056589 -0.4002277690089273 -1.6760387996450654 0.8617861127170636 -1.6760387996450654 0.6560139594854928 -0.5271525440329565 0.861786111982288 -0.17794664988142392 0.8585602431392232 0.6186908097378694 0.45268991793949637 -1.6760387996450654 0.43242424670212776 -1.6760387996450654 0.8617861127170636 -1.6760387996450654 0.75257692018441 0.4137569115566293 0.7549338482518237 -1.6760387996450654 0.7518120543281679 -1.6760387996450654 0.5394377956663703 0.8370996272100791 0.8614089388928073 0.8484740194990685 0.8617861127170636 0.8595403372152429 0.8608246893240517 0.8613063423635211 0.8613275658871784 0.8538284301128597 0.8617861127170636 0.8564771138889471 0.8563923780229442 -0.1704410971302879 0.6556998683772913 -1.6760387996450654 0.6325227570538018 -1.6760387996450654 -0.20433369936533838 -1.6760387996450654 0.44968856257304546 -1.6760387996450654 0.2916725596888235 0.26812944624327284 0.737964014915268 0.43807399991671725 0.7533722241896819 0.7951438958025596 0.8472532496927322 0.8040727937364881 0.8044113097637438 0.7705632215704827 0.8278886231610122 0.7883543307292633 -1.6760387996450654 0.7858058463669277 -1.6760387996450654 0.10366759757981923 -1.6760387996450654 0.5773369675561135 -1.6760387996450654 -0.8094773809351361 0.3675651121381356 -1.6760387996450654 0.08680399659436283 -1.4136425270600894 0.03829374236034191 -1.6760387996450654 0.2044085658759476 -1.6760387996450654 -0.13596127584262707 -1.6760387996450654 0.04946451538444231 -1.6760387996450654 0.500391153424014 -1.6760387996450654 0.3495707726722738 0.23685012554739351 0.3301379303605078 0.7793751728345026 -1.6760387996450654 0.7864429463510544 -1.6760387996450654 0.49015211993395913 0.6734471765622073 0.723858509108584 0.5305534051197547 0.7602544130781392 0.5712532543508461 -1.6760387996450654 0.8143466421473193 -3.0918609819991087 0.5176836359873626 -1.6760387996450654 0.6974471746428382 0.5134038747370456 -1.3242367055405815 0.47004936187331836 0.5475065518159601"
                    
                    self$attributes$predictorName <- "Host genetic distance" }
                  else if (self$attributes$predictorName == "HostDistanceNotLogged") {
                    predictor <- "-0.006640472594712263 0.6957739618680051 0.2838316619575395 -0.19148637640069066 0.6007103541963591 -0.18620506486337698 0.8964638002859245 0.2204559235097755 0.2521437927336575 -0.15451719563949498 -0.05417227643053528 0.17820543121126614 -0.03304703028128061 -0.7935558916544483 -0.40273883789323683 0.9334329810471201 1.1869359348381756 0.7749936349277101 0.2996755965694805 1.0918723271665296 -0.846369007027585 1.3876257732560946 0.7116178964799461 0.7433057657038281 0.3366447773306762 0.4369896965396353 0.6693674041814367 -0.6932109724454886 -0.30239391868427773 0.08842313507693378 1.4245949540172909 -2.272323122102274 -1.057621468520131 -0.265424737923082 1.0073713425695114 -3.3180228064903794 -0.6456791686096656 1.0443405233307066 0.6376795349575547 0.7380244541665144 0.9704021618083158 1.1605293771516074 -0.0013591610573985943 0.3894578927038123 0.48980281191277203 -1.469563768430597 -0.6773670378335476 0.5954290426590454 -2.071633283684355 -1.057621468520131 0.6323982234202411 0.22573723504708915 0.32608215425604886 0.5584598618978497 0.7485870772411418 -0.4133014609678642 -0.02248440720665327 0.07786051200230644 -0.5083650686395103 0.12011100430081578 -0.8569316301022123 -0.8886194993260943 0.15708018506201146 -0.24958080331114102 -0.1492358841021813 0.0831418235396201 0.27326903888291215 -0.8886194993260943 -0.49780244556488285 -0.39745752635592313 0.9123077348978655 -0.06473489950516262 -2.055789349072414 0.9492769156590611 0.5426159272859087 0.6429608464948684 0.8753385541366698 1.0654657694799612 -0.09642276872904464 0.29439428503216686 0.39473920424112596 1.2080611809874304 0.5320533042112814 0.5637411734351634 0.15708018506201146 0.25742510427097115 0.48980281191277203 -1.1368411415798363 -0.48195851095294184 -0.09114145719173096 1.245030361748626 -0.4449893301917462 1.245030361748626 0.8383693733754741 0.9387142925844338 1.1710920002262346 1.3612192155695269 0.19933067736052082 0.5901477311217317 0.6904926503306914 0.569022484972477 0.16236149659932514 0.26270641580828485 0.4950841234500857 0.6852113387933777 -0.4766771994156282 -0.0858601456544173 0.014484773554542411 -2.4994195182067616 -2.399074598997802 -2.9060805065799133 0.7168992080172597 -0.8991821224007217 -0.5083650686395103 1.2819995425098216 -3.2071152642067924 -2.5733578797291528 0.31023821964410786 -1.3058431107738735 -0.9150260570126627 0.8753385541366698 -2.4730129605201934 0.41058313885306696 -1.205498191564914 -0.814681137803703 0.9756834733456295 0.6429608464948684 -0.9731204839231125 -0.5823034301619016 1.2080611809874304 -0.3288004763708455 0.06201657739036543 1.3981883963307218 -1.6491283606992617 0.2362998581217165 0.6271169118829274 -0.006640472594712263 0.6957739618680051 0.2838316619575395 -0.19148637640069066 0.6007103541963591 -0.18620506486337698 0.8964638002859245 0.2204559235097755 0.2521437927336575 -0.15451719563949498 -0.05417227643053528 0.17820543121126614 -0.03304703028128061 -0.7935558916544483 -0.40273883789323683 0.9334329810471201 1.1869359348381756 0.7749936349277101 0.2996755965694805 1.0918723271665296 -0.846369007027585 1.3876257732560946 0.7116178964799461 0.7433057657038281 0.3366447773306762 0.4369896965396353 0.6693674041814367 -0.6932109724454886 -0.30239391868427773 0.08842313507693378 1.4245949540172909 -2.272323122102274 -1.057621468520131 -0.265424737923082 1.0073713425695114 -3.3180228064903794 -0.6456791686096656 1.0443405233307066 0.6376795349575547 0.7380244541665144 0.9704021618083158 1.1605293771516074 -0.0013591610573985943 0.3894578927038123 0.48980281191277203 -1.469563768430597 -0.6773670378335476 0.5954290426590454 -2.071633283684355 -1.057621468520131 0.6323982234202411 0.22573723504708915 0.32608215425604886 0.5584598618978497 0.7485870772411418 -0.4133014609678642 -0.02248440720665327 0.07786051200230644 -0.5083650686395103 0.12011100430081578 -0.8569316301022123 -0.8886194993260943 0.15708018506201146 -0.24958080331114102 -0.1492358841021813 0.0831418235396201 0.27326903888291215 -0.8886194993260943 -0.49780244556488285 -0.39745752635592313 0.9123077348978655 -0.06473489950516262 -2.055789349072414 0.9492769156590611 0.5426159272859087 0.6429608464948684 0.8753385541366698 1.0654657694799612 -0.09642276872904464 0.29439428503216686 0.39473920424112596 1.2080611809874304 0.5320533042112814 0.5637411734351634 0.15708018506201146 0.25742510427097115 0.48980281191277203 -1.1368411415798363 -0.48195851095294184 -0.09114145719173096 1.245030361748626 -0.4449893301917462 1.245030361748626 0.8383693733754741 0.9387142925844338 1.1710920002262346 1.3612192155695269 0.19933067736052082 0.5901477311217317 0.6904926503306914 0.569022484972477 0.16236149659932514 0.26270641580828485 0.4950841234500857 0.6852113387933777 -0.4766771994156282 -0.0858601456544173 0.014484773554542411 -2.4994195182067616 -2.399074598997802 -2.9060805065799133 0.7168992080172597 -0.8991821224007217 -0.5083650686395103 1.2819995425098216 -3.2071152642067924 -2.5733578797291528 0.31023821964410786 -1.3058431107738735 -0.9150260570126627 0.8753385541366698 -2.4730129605201934 0.41058313885306696 -1.205498191564914 -0.814681137803703 0.9756834733456295 0.6429608464948684 -0.9731204839231125 -0.5823034301619016 1.2080611809874304 -0.3288004763708455 0.06201657739036543 1.3981883963307218 -1.6491283606992617 0.2362998581217165 0.6271169118829274"
                    self$attributes$predictorName <- "Host distance Not Logged" }
                  else if (self$attributes$predictorName == "RangeOverlap") {
                    predictor <- "0.8617857453290947 0.11763925837474469 0.6925555935399687 0.8610850307856458 -0.5213081646901465 0.8125411449373177 -0.786023743931082 -0.029083319976992775 -1.6760387996450654 0.7169257333564394 0.6382732111740821 0.7452569963503566 -0.4013362029605582 0.6282942278835917 -0.16783846588677617 0.7673497688688244 0.6591612434340255 0.45074915834567114 0.8590893931054254 0.008783013680845613 0.8289618895009672 -1.1074823773308233 -0.4139255674775493 0.0550257862828396 0.36105655125643366 0.7407030590383533 0.40956680757972846 0.4164069058770259 0.24345198245481484 0.5637811226399678 0.5836023230618462 -1.6760387996450654 0.8576907189989589 0.21140785627624364 0.8332739268776149 -0.904857516378091 -1.6760387996450654 0.2576506292012054 -1.6760387996450654 0.7375599060985056 -0.7767470229709207 0.6190317503241856 -0.5936559412924872 0.7631800969484168 0.5433513673407716 0.8610331655176797 -1.6760387996450654 0.8106402473124762 -1.6760387996450654 -0.0028886098734439113 -1.6760387996450654 0.6628843130503459 0.7037149688274674 0.7137514990281232 -1.6760387996450654 0.5445148794004447 -1.6760387996450654 0.6725104636127779 -0.013209765204893913 0.8312816921049386 -1.1047717063445526 -0.41123185819537267 0.05547371878915598 0.36278883437008824 0.4240902214568601 0.4118019687829002 0.4111429318684383 0.24614569091324423 0.561165831722412 0.5811217985482124 0.6497410499204633 0.8014483811757893 -0.8300971621910221 0.6787655313207953 -1.6760387996450654 0.5275905045104599 -1.6760387996450654 0.8573124574493542 -1.6760387996450654 0.8466706697238874 0.8431682604413908 0.063530390013931 -0.804816713328432 -0.02056714630710059 0.32723528935975815 0.7589953065287 -1.6760387996450654 0.3918530582524419 0.18505004582860235 0.5627045871011578 0.5432109982740396 -1.6760387996450654 0.6863001013689891 -1.6760387996450654 0.6898432798194667 -1.6760387996450654 0.8392123466394302 -1.6760387996450654 -0.4002277690089273 0.7968554048012869 -1.6760387996450654 0.8617861127170636 -0.2590097246608637 0.8617861127170636 -1.6760387996450654 0.8617861127170636 -1.6760387996450654 0.8617861127170636 -1.6760387996450654 0.7351459446363632 -1.6760387996450654 0.8617722747955313 -1.6760387996450654 0.8583261096439491 0.7656461648137879 0.7097885954547359 0.8278854301781329 -1.6760387996450654 0.66883837870321 -1.6760387996450654 0.7129173945345594 -0.5695739850563394 0.39955820098687295 0.0332981728892891 0.5833283208050997 0.41436786470989945 -1.6760387996450654 0.6482318166673172 -2.9371664590166495 0.6919386531894527 -1.6760387996450654 0.8448213901955979 0.6808187934850704 -1.0039076519149899 0.8104192036917462 0.5675472553439994 0.4769438681103487 -0.06457813964162111 0.7187503037013698 0.478936493178435 -0.05314731441070776 0.4605198542248416 -0.4636113860490779 0.8617861127170636 -1.6760387996450654 0.8328130500909449 0.3745098630756987 0.8126340561473551 -0.34079923686912433 0.8617861127170636 -0.2546757151381716 0.6604718111638693 0.8617860881020811 0.8617857453290947 0.8617831012270462 0.8617861127170636 0.8617828440533984 -0.4002277690089273 0.8617861127170636 0.8617861127170636 0.8617861127170636 0.8617819564355401 0.8617861127170636 0.861786111982288 0.8617861127170636 0.8617861127170636 0.8615666101069817 -2.542763693238067 0.6577595827042949 0.8617861127170636 0.6634700371056589 -0.4002277690089273 -1.6760387996450654 0.8617861127170636 -1.6760387996450654 0.6560139594854928 -0.5271525440329565 0.861786111982288 -0.17794664988142392 0.8585602431392232 0.6186908097378694 0.45268991793949637 -1.6760387996450654 0.43242424670212776 -1.6760387996450654 0.8617861127170636 -1.6760387996450654 0.75257692018441 0.4137569115566293 0.7549338482518237 -1.6760387996450654 0.7518120543281679 -1.6760387996450654 0.5394377956663703 0.8370996272100791 0.8614089388928073 0.8484740194990685 0.8617861127170636 0.8595403372152429 0.8608246893240517 0.8613063423635211 0.8613275658871784 0.8538284301128597 0.8617861127170636 0.8564771138889471 0.8563923780229442 -0.1704410971302879 0.6556998683772913 -1.6760387996450654 0.6325227570538018 -1.6760387996450654 -0.20433369936533838 -1.6760387996450654 0.44968856257304546 -1.6760387996450654 0.2916725596888235 0.26812944624327284 0.737964014915268 0.43807399991671725 0.7533722241896819 0.7951438958025596 0.8472532496927322 0.8040727937364881 0.8044113097637438 0.7705632215704827 0.8278886231610122 0.7883543307292633 -1.6760387996450654 0.7858058463669277 -1.6760387996450654 0.10366759757981923 -1.6760387996450654 0.5773369675561135 -1.6760387996450654 -0.8094773809351361 0.3675651121381356 -1.6760387996450654 0.08680399659436283 -1.4136425270600894 0.03829374236034191 -1.6760387996450654 0.2044085658759476 -1.6760387996450654 -0.13596127584262707 -1.6760387996450654 0.04946451538444231 -1.6760387996450654 0.500391153424014 -1.6760387996450654 0.3495707726722738 0.23685012554739351 0.3301379303605078 0.7793751728345026 -1.6760387996450654 0.7864429463510544 -1.6760387996450654 0.49015211993395913 0.6734471765622073 0.723858509108584 0.5305534051197547 0.7602544130781392 0.5712532543508461 -1.6760387996450654 0.8143466421473193 -3.0918609819991087 0.5176836359873626 -1.6760387996450654 0.6974471746428382 0.5134038747370456 -1.3242367055405815 0.47004936187331836 0.5475065518159601"
                    # predictor <- "1.48488 -0.7741325 0.5243225 1.479922 -1.05714 1.158432 -1.08811 -0.8871717 -1.114848 0.6369203 0.2988165 0.7775625 -1.03385 0.2608656 -0.9596058 0.8950146 0.3816721 -0.2673499 1.465851 -0.8621708 1.262462 -1.105219 -1.036666 -0.8279293 -0.4514977 0.7542179 -0.3574952 -0.3432136 -0.6339227 0.03889328 0.1029936 -1.114848 1.456035 -0.6743098 1.290559 -1.096218 -1.114848 -0.6148697 -1.114848 0.7382733 -1.08736 0.2265503 -1.067921 0.8723033 -0.02365365 1.479555 -1.114848 1.146686 -1.114848 -0.8701534 -1.114848 0.3969413 0.5749563 0.6218278 -1.114848 -0.02018412 -1.114848 0.4371452 -0.8770041 1.277537 -1.105128 -1.036071 -0.8275761 -0.4483503 -0.3268513 -0.3528576 -0.3542279 -0.6303644 0.03069095 0.09478118 0.3437218 1.090741 -1.091427 0.46384 -1.114848 -0.06958503 -1.114848 1.453387 -1.114848 1.379988 1.356292 -0.821149 -1.089573 -0.8817714 -0.5100672 0.8497673 -1.114848 -0.3932674 -0.7049887 0.03550988 -0.02407148 -1.114848 0.4966047 -1.114848 0.5122464 -1.114848 1.329798 -1.114848 -1.033597 1.063307 -1.114848 1.484883 -0.9942945 1.484883 -1.114848 1.484883 -1.114848 1.484883 -1.114848 0.7261201 -1.114848 1.484785 -1.114848 1.46049 0.8857043 0.6031676 1.255499 -1.114848 0.4216842 -1.114848 0.6178835 -1.064565 -0.3779189 -0.8445553 0.1020837 -0.3474988 -1.114848 0.3377316 -1.117366 0.5215678 -1.114848 1.367448 0.4727023 -1.101236 1.145324 0.05080805 -0.2045248 -0.9083788 0.6456548 -0.1995599 -0.9017716 -0.2444382 -1.046885 1.484883 -1.114848 1.28754 -0.4266593 1.159007 -1.018874 1.484883 -0.9928331 0.3870295 1.484883 1.48488 1.484862 1.484883 1.48486 -1.033597 1.484883 1.484883 1.484883 1.484853 1.484883 1.484883 1.484883 1.484883 1.483329 -1.117204 0.3759636 1.484883 0.3993576 -1.033597 -1.114848 1.484883 -1.114848 0.3688845 -1.058092 1.484883 -0.9638895 1.462133 0.2253036 -0.2628473 -1.114848 -0.3087119 -1.114848 1.484883 -1.114848 0.8156978 -0.3487782 0.8281395 -1.114848 0.8116774 -1.114848 -0.0352434 1.315766 1.482213 1.392277 1.484883 1.469024 1.478082 1.481487 1.481637 1.429122 1.484883 1.447548 1.446956 -0.9607201 0.3676144 -1.114848 0.2768213 -1.114848 -0.974532 -1.114848 -0.2698005 -1.114848 -0.5661052 -0.6003285 0.7403157 -0.2961789 0.8198871 1.053172 1.383951 1.106572 1.108622 0.9126944 1.255519 1.013425 -1.114848 0.9986952 -1.114848 -0.7869436 -1.114848 0.08235687 -1.114848 -1.089924 -0.4395947 -1.114848 -0.8017714 -1.112134 -0.8408192 -1.114848 -0.6826723 -1.114848 -0.9452984 -1.114848 -0.8322788 -1.114848 -0.144361 -1.114848 -0.4719956 -0.6425339 -0.5052494 0.9619769 -1.114848 1.002368 -1.114848 -0.1711064 0.441114 0.6703404 -0.06110006 0.8565209 0.06265241 -1.114848 1.169644 -1.117395 -0.09746386 -1.114848 0.546328 -0.1092769 -1.11067 -0.2214973 -0.01121251"
                    self$attributes$predictorName <- "Range overlap" }
                  else if (self$attributes$predictorName == "BodySize")  {
                    predictor <- "-1.2392695626831902 0.3364461836254389 0.24434933661489383 -0.06699125230272077 -0.29290111344070846 0.1425498870075128 0.5965191943068945 -0.29290111344070846 0.6100617949725378 0.6474226748262661 0.5073033228865643 0.5706804492815892 0.6829603310314847 0.9666376914346936 0.7492221244336471 0.3336501054614252 0.41569573511339397 0.3336501054614252 -0.2295239870456835 -0.5248556355542032 0.24434933661489383 0.6528651220698523 -0.5248556355542032 0.6654082174450192 0.7000994151386286 0.5706804492815892 0.6289817539699446 0.733213184024552 1.0010556280231409 0.7952402127813797 0.41318840917011573 -1.2153861945832822 0.6671825848688209 0.5926031769856188 -0.7223572037735408 -0.27977684003875114 0.5926031769856188 -0.23561923154614312 -0.12246547150634236 -0.6325973252570558 -0.3696433389853853 -0.024549492583029624 0.5686543632261795 0.1388988644895154 -3.7166250972096857 0.6100617949725378 0.5290475485759114 -1.2392695626831902 -0.10180089498679643 0.5290475485759114 -0.06699125230272077 0.024174760757158128 -0.3623229008112402 -0.17122268235732813 0.10518900715378444 0.6289817539699446 0.24434933661489383 -1.2392695626831902 -1.0297284233729564 0.5501614172659276 0.8427129957305048 -1.0297284233729564 0.85239716928892 0.8793771969397609 0.7802215885918229 0.8243791970844309 0.9053934434810575 1.124455992455213 0.954793894425682 0.6654082174450192 0.46176490361594025 0.7847597806388653 -7.07092729360813 0.7952402127813797 0.8243791970844309 0.7168444621967979 0.7648867597229931 0.85239716928892 1.085599982140276 0.9053934434810575 0.5906372447064119 0.03691638247326436 0.46176490361594025 0.06580766146283594 0.1425498870075128 -0.17122268235732813 -0.019982847735449907 0.21197167437804487 0.6829603310314847 0.3336501054614252 -0.7343967748644368 0.7847597806388653 -2.299267991313764 -1.3160117882278668 -0.977051683060594 -1.8483737805565505 -0.9122643384762292 0.2962892256076968 -0.4637582527018342 -0.27330233103231755 0.7952402127813797 0.8243791970844309 0.7168444621967979 0.7648867597229931 0.85239716928892 1.085599982140276 0.9053934434810575 0.5906372447064119 -1.5346012111917096 -0.8671956886299936 -1.5346012111917096 -1.0297284233729564 0.27534880077306984 -0.5248556355542032 -0.2295239870456835 -0.6221168931145415 -1.0297284233729564 -1.5346012111917096 0.21197167437804487 -0.7343967748644368 -0.11724410529578842 -1.2392695626831902 -0.43906512635591705 0.41318840917011573 -0.17122268235732813 -0.6221168931145415 -0.7343967748644368 0.3336501054614252 -0.3623229008112402 -0.3623229008112402 0.1425498870075128 -1.0297284233729564 -0.019982847735449907 -0.019982847735449907 0.5706804492815892 0.1425498870075128 -1.2392695626831902 0.3364461836254389 0.24434933661489383 -0.06699125230272077 -0.29290111344070846 0.1425498870075128 0.5965191943068945 -0.29290111344070846 0.6100617949725378 0.6474226748262661 0.5073033228865643 0.5706804492815892 0.6829603310314847 0.9666376914346936 0.7492221244336471 0.3336501054614252 0.41569573511339397 0.3336501054614252 -0.2295239870456835 -0.5248556355542032 0.24434933661489383 0.6528651220698523 -0.5248556355542032 0.6654082174450192 0.7000994151386286 0.5706804492815892 0.6289817539699446 0.733213184024552 1.0010556280231409 0.7952402127813797 0.41318840917011573 -1.2153861945832822 0.6671825848688209 0.5926031769856188 -0.7223572037735408 -0.27977684003875114 0.5926031769856188 -0.23561923154614312 -0.12246547150634236 -0.6325973252570558 -0.3696433389853853 -0.024549492583029624 0.5686543632261795 0.1388988644895154 -3.7166250972096857 0.6100617949725378 0.5290475485759114 -1.2392695626831902 -0.10180089498679643 0.5290475485759114 -0.06699125230272077 0.024174760757158128 -0.3623229008112402 -0.17122268235732813 0.10518900715378444 0.6289817539699446 0.24434933661489383 -1.2392695626831902 -1.0297284233729564 0.5501614172659276 0.8427129957305048 -1.0297284233729564 0.85239716928892 0.8793771969397609 0.7802215885918229 0.8243791970844309 0.9053934434810575 1.124455992455213 0.954793894425682 0.6654082174450192 0.46176490361594025 0.7847597806388653 -7.07092729360813 0.7952402127813797 0.8243791970844309 0.7168444621967979 0.7648867597229931 0.85239716928892 1.085599982140276 0.9053934434810575 0.5906372447064119 0.03691638247326436 0.46176490361594025 0.06580766146283594 0.1425498870075128 -0.17122268235732813 -0.019982847735449907 0.21197167437804487 0.6829603310314847 0.3336501054614252 -0.7343967748644368 0.7847597806388653 -2.299267991313764 -1.3160117882278668 -0.977051683060594 -1.8483737805565505 -0.9122643384762292 0.2962892256076968 -0.4637582527018342 -0.27330233103231755 0.7952402127813797 0.8243791970844309 0.7168444621967979 0.7648867597229931 0.85239716928892 1.085599982140276 0.9053934434810575 0.5906372447064119 -1.5346012111917096 -0.8671956886299936 -1.5346012111917096 -1.0297284233729564 0.27534880077306984 -0.5248556355542032 -0.2295239870456835 -0.6221168931145415 -1.0297284233729564 -1.5346012111917096 0.21197167437804487 -0.7343967748644368 -0.11724410529578842 -1.2392695626831902 -0.43906512635591705 0.41318840917011573 -0.17122268235732813 -0.6221168931145415 -0.7343967748644368 0.3336501054614252 -0.3623229008112402 -0.3623229008112402 0.1425498870075128 -1.0297284233729564 -0.019982847735449907 -0.019982847735449907 0.5706804492815892 0.1425498870075128"
                    self$attributes$predictorName <- "Body size" }
                } else if (self$attributes$tree == "cattle") {
                  predictor <- "1.168166255990229 1.168166255990229 1.168166255990229 1.168166255990229 1.168166255990229 1.168166255990229 1.168166255990229 1.168166255990229 -0.15384421985344357 -0.15384421985344357 -0.15384421985344357 -0.15384421985344357 -0.15384421985344357 -0.15384421985344357 -0.15384421985344357 0.7508451407299077 0.7508451407299077 0.7508451407299077 0.7508451407299077 0.7508451407299077 0.7508451407299077 0.27445508954747616 0.27445508954747616 0.27445508954747616 0.27445508954747616 0.27445508954747616 -1.674896380012562 -1.674896380012562 -1.674896380012562 -1.674896380012562 0.20625687259643835 0.20625687259643835 0.20625687259643835 -1.649121622690377 -1.649121622690377 -0.052120859197237523 -0.15384421985344357 0.7508451407299077 0.27445508954747616 -1.674896380012562 0.20625687259643835 -1.649121622690377 -0.052120859197237523 1.1302597228895628 0.7508451407299077 0.27445508954747616 -1.674896380012562 0.20625687259643835 -1.649121622690377 -0.052120859197237523 1.1302597228895628 0.27445508954747616 -1.674896380012562 0.20625687259643835 -1.649121622690377 -0.052120859197237523 1.1302597228895628 -1.674896380012562 0.20625687259643835 -1.649121622690377 -0.052120859197237523 1.1302597228895628 0.20625687259643835 -1.649121622690377 -0.052120859197237523 1.1302597228895628 -1.649121622690377 -0.052120859197237523 1.1302597228895628 -0.052120859197237523 1.1302597228895628 1.1302597228895628"
                } else if (self$attributes$tree == "airco") {
                  if (self$attributes$predictorName == "totalSeats")  {
                  predictor <- "0.6172698155961509 -1.378064199628241 -1.378064199628241 -0.12549902074912178 0.45904729171563496 0.8553085314372838 -1.378064199628241 -1.378064199628241 0.48523147113636905 -1.378064199628241 1.0619064121635942 0.6513981255921586 -1.378064199628241 -1.378064199628241 0.9323033376250268 0.5845820237238963 0.8500871309865877 0.668212801303347 0.6642051665724404 1.1347493573451921 0.9899042739178111 1.1755779119784158 1.3013576220204846 1.0834387492327993 -0.21724735419900096 0.6446604983114443 -1.378064199628241 -1.378064199628241 -1.378064199628241 0.07311789162538929 -1.378064199628241 -1.378064199628241 -1.378064199628241 -1.378064199628241 0.8395567375268961 0.10252802369987514 0.7195884572820302 0.7408869957054025 0.7198130905903594 1.0193346245497037 -1.378064199628241 -1.378064199628241 0.6903984919081697 0.9571903612315948 1.2959388212533987 0.8082234873753079 -1.378064199628241 0.8076180461639078 0.3011456245461176 -1.378064199628241 -1.378064199628241 0.3670657026654236 1.1147358056213366 0.7355326197698646 0.11405938593433244 0.5895752718546523 0.4714766545926382 -1.378064199628241 0.3890199151067679 -0.06108293515773794 0.20451992340896974 1.087252049739244 -1.378064199628241 0.3110188893763053 -1.378064199628241 -0.3113203362867962 0.4279929857567639 1.2062456175424296 1.083889442280672 -1.378064199628241 -1.378064199628241 -1.378064199628241 0.21596349496276168 0.5113877597771295 0.9759741882054735 0.7423368459930448 0.6275455838235057 0.5947557741909708 0.8062543834482163 -0.12413815156260619 -1.378064199628241 0.46028926503249923 0.9598793784898456 -0.07664589147324342 -1.378064199628241 0.9959995460023828 0.7630295760801074 -1.378064199628241 1.1405657672860126 -1.378064199628241 0.74884847758936 0.6172698155961509 -1.378064199628241 -1.378064199628241 -0.12549902074912178 0.45904729171563496 0.8553085314372838 -1.378064199628241 -1.378064199628241 0.48523147113636905 -1.378064199628241 1.0619064121635942 0.6513981255921586 -1.378064199628241 -1.378064199628241 0.9323033376250268 0.5845820237238963 0.8500871309865877 0.668212801303347 0.6642051665724404 1.1347493573451921 0.9899042739178111 1.1755779119784158 1.3013576220204846 1.0834387492327993 -0.21724735419900096 0.6446604983114443 -1.378064199628241 -1.378064199628241 -1.378064199628241 0.07311789162538929 -1.378064199628241 -1.378064199628241 -1.378064199628241 -1.378064199628241 0.8395567375268961 0.10252802369987514 0.7195884572820302 0.7408869957054025 0.7198130905903594 1.0193346245497037 -1.378064199628241 -1.378064199628241 0.6903984919081697 0.9571903612315948 1.2959388212533987 0.8082234873753079 -1.378064199628241 0.8076180461639078 0.3011456245461176 -1.378064199628241 -1.378064199628241 0.3670657026654236 1.1147358056213366 0.7355326197698646 0.11405938593433244 0.5895752718546523 0.4714766545926382 -1.378064199628241 0.3890199151067679 -0.06108293515773794 0.20451992340896974 1.087252049739244 -1.378064199628241 0.3110188893763053 -1.378064199628241 -0.3113203362867962 0.4279929857567639 1.2062456175424296 1.083889442280672 -1.378064199628241 -1.378064199628241 -1.378064199628241 0.21596349496276168 0.5113877597771295 0.9759741882054735 0.7423368459930448 0.6275455838235057 0.5947557741909708 0.8062543834482163 -0.12413815156260619 -1.378064199628241 0.46028926503249923 0.9598793784898456 -0.07664589147324342 -1.378064199628241 0.9959995460023828 0.7630295760801074 -1.378064199628241 1.1405657672860126 -1.378064199628241 0.74884847758936"
                  self$attributes$predictorName <- "Total seats"
                  } else if (self$attributes$predictorName == "donorPopDensity") {
                    predictor <- "-0.08526549298973733 -0.08526549298973733 -0.08526549298973733 -0.08526549298973733 -0.08526549298973733 -0.08526549298973733 -0.08526549298973733 -0.08526549298973733 -0.08526549298973733 -0.08526549298973733 -0.08526549298973733 -0.08526549298973733 -0.08526549298973733 -0.7153185711115634 -0.7153185711115634 -0.7153185711115634 -0.7153185711115634 -0.7153185711115634 -0.7153185711115634 -0.7153185711115634 -0.7153185711115634 -0.7153185711115634 -0.7153185711115634 -0.7153185711115634 -0.7153185711115634 1.3687911218642295 1.3687911218642295 1.3687911218642295 1.3687911218642295 1.3687911218642295 1.3687911218642295 1.3687911218642295 1.3687911218642295 1.3687911218642295 1.3687911218642295 1.3687911218642295 0.5185696114493206 0.5185696114493206 0.5185696114493206 0.5185696114493206 0.5185696114493206 0.5185696114493206 0.5185696114493206 0.5185696114493206 0.5185696114493206 0.5185696114493206 -1.065977290955883 -1.065977290955883 -1.065977290955883 -1.065977290955883 -1.065977290955883 -1.065977290955883 -1.065977290955883 -1.065977290955883 -1.065977290955883 -1.6002338509023792 -1.6002338509023792 -1.6002338509023792 -1.6002338509023792 -1.6002338509023792 -1.6002338509023792 -1.6002338509023792 -1.6002338509023792 1.388358258207128 1.388358258207128 1.388358258207128 1.388358258207128 1.388358258207128 1.388358258207128 1.388358258207128 1.0206763067751603 1.0206763067751603 1.0206763067751603 1.0206763067751603 1.0206763067751603 1.0206763067751603 -7.712677579479551E-4 -7.712677579479551E-4 -7.712677579479551E-4 -7.712677579479551E-4 -7.712677579479551E-4 -0.5276232188630482 -0.5276232188630482 -0.5276232188630482 -0.5276232188630482 -1.613116317903099 -1.613116317903099 -1.613116317903099 -0.2926564040874302 -0.2926564040874302 0.38891263061097425 -0.7153185711115634 1.3687911218642295 0.5185696114493206 -1.065977290955883 -1.6002338509023792 1.388358258207128 1.0206763067751603 -7.712677579479551E-4 -0.5276232188630482 -1.613116317903099 -0.2926564040874302 0.38891263061097425 1.215654485664261 1.3687911218642295 0.5185696114493206 -1.065977290955883 -1.6002338509023792 1.388358258207128 1.0206763067751603 -7.712677579479551E-4 -0.5276232188630482 -1.613116317903099 -0.2926564040874302 0.38891263061097425 1.215654485664261 0.5185696114493206 -1.065977290955883 -1.6002338509023792 1.388358258207128 1.0206763067751603 -7.712677579479551E-4 -0.5276232188630482 -1.613116317903099 -0.2926564040874302 0.38891263061097425 1.215654485664261 -1.065977290955883 -1.6002338509023792 1.388358258207128 1.0206763067751603 -7.712677579479551E-4 -0.5276232188630482 -1.613116317903099 -0.2926564040874302 0.38891263061097425 1.215654485664261 -1.6002338509023792 1.388358258207128 1.0206763067751603 -7.712677579479551E-4 -0.5276232188630482 -1.613116317903099 -0.2926564040874302 0.38891263061097425 1.215654485664261 1.388358258207128 1.0206763067751603 -7.712677579479551E-4 -0.5276232188630482 -1.613116317903099 -0.2926564040874302 0.38891263061097425 1.215654485664261 1.0206763067751603 -7.712677579479551E-4 -0.5276232188630482 -1.613116317903099 -0.2926564040874302 0.38891263061097425 1.215654485664261 -7.712677579479551E-4 -0.5276232188630482 -1.613116317903099 -0.2926564040874302 0.38891263061097425 1.215654485664261 -0.5276232188630482 -1.613116317903099 -0.2926564040874302 0.38891263061097425 1.215654485664261 -1.613116317903099 -0.2926564040874302 0.38891263061097425 1.215654485664261 -0.2926564040874302 0.38891263061097425 1.215654485664261 0.38891263061097425 1.215654485664261 1.215654485664261"
                    self$attributes$predictorName <- "Origin population density"
                  }
                } else {
                  stop("Tree not recognized")
                }
                predictor <- as.numeric(strsplit(predictor, " ")[[1]])
              } else {
                stop("Data type not recognized")
              }
              cat("Loading predictor: ", self$attributes$predictorName, "of size", length(predictor), "\n")
              return(predictor)
            }
          )
)

# ---- DataToPlotSkyGrid ----
DataToPlotSkyGrid <- 
  R6Class("DataToPlotSkyGrid",
           inherit = DataToPlot,
           public = list(
             initialize = function(data, path, jobName = NULL, attributes = list(),
                                   plottingFlags = list(), actions = list(), gridResults = NULL) {
               defaultsPlotting <- list(
                 plottingDemographic = FALSE,
                 plottingDemographicCovariate = FALSE,
                 plottingDemographicGridCovariate = FALSE,
                 plottingDemographicGridCovariates = FALSE,
                 plottingHyperpar = FALSE, 
                 plottingDemographicMeanCovariate = FALSE
               )
               plottingFlags <- modifyList(defaultsPlotting, plottingFlags)
               defaultsActions <- list(
                 logPop = FALSE,
                 publicationQuality = FALSE,
                 useInputFile = TRUE, 
                 plotGmrfMean = FALSE
               )
               actions <- modifyList(defaultsActions, actions)
               # actions$logPop <- ifelse(is.null(actions$logPop), FALSE, actions$logPop)
               # actions$publicationQuality <- ifelse(is.null(actions$publicationQuality), FALSE, actions$publicationQuality)
               # cat("actions is:", actions$logPop, "|")
               super$initialize(data = data, path = path, jobName = jobName, attributes = attributes, 
                                plottingFlags = plottingFlags, actions = actions, gridResults = gridResults)
               cat("Loading data to plot Np Coalescent. Nrows=", nrow(self$data), "...\n")
               
             },
             
             plotCreator = function() {
               cat("Creating plots ... \n")
               # cat("dem plot is ", self$plottingFlags$plottingDemographic, "\n")
               self$data <- self$data %>%
                 rename_with(~ str_replace(., "skygrid\\.Pop", "PopSize")) # TODO CHANGE BACK "PopSize"
               # 
               # self$data <- self$data %>%
               #   rename_with(~ str_replace(., "branchRates.log.rates", "PopSize"))
               # self$data <- dplyr::select(self$data, 69:129)
               # print(names(self$data))
               
               
               # if (self$actions$plotGmrfMean) {
               #   self$data <- self$data %>% dplyr::select(-contains("PopSize"))
               #   self$data <- self$data %>%
               #     rename_with(~ str_replace(., "gmrf.mean", "PopSize"))
               #   self$actions$logPop <- FALSE
               #   # self$data <- self$data %>%
               #   #   mutate(across(contains("PopSize"), ~ . - gp.mean))
               #   self$data <- self$data %>%
               #     rowwise() %>%
               #     mutate(
               #       popsize_mean = mean(c_across(contains("PopSize"))),
               #       popsize_sd = sd(c_across(contains("PopSize")))
               #     ) %>%
               #     mutate(across(
               #       contains("PopSize"),
               #       ~ (. - popsize_mean)
               #     )) %>%
               #     ungroup() %>%
               #     dplyr::select(-popsize_mean, -popsize_sd)  # clean up helper columns
               # }
               
               
               if (self$actions$logPop) {
                 head(self$data)
                 self$data <- self$data %>%
                   mutate(across(contains("PopSize"), ~ log(.x / as.numeric(self$attributes$N0))))
               }
               summStat <- self$summStatCalculator(self$data)
               inputs <- self$inputsSetter()
               
               if (self$plottingFlags$plottingDemographic) {
                 cat("Plotting demography vs time\n")
                 cat(length(inputs$gridPoints))
                 self$gridResults$plottingDemographic[[self$jobName]] <- plotDemographicQuantiles(summStat, inputs$gridPoints, "Time", self$jobName, self$attributes, self$actions)
                 # self$gridResults$logRatesBoxPlots[[self$jobName]] <- boxPlotLogRates(self$data, inputs$logRates, inputs$predictor, self$jobName)
               }
               if (self$plottingFlags$plottingDemographicCovariate) {
                 cat("Plotting demography vs covariate\n")
                 self$gridResults$plottingDemographicCovariate[[self$jobName]] <- plotDemographicQuantiles(summStat, inputs$covariate, self$attributes$covariate, self$jobName, self$attributes, self$actions)
               }
               if (self$plottingFlags$plottingDemographicGridCovariate) {
                 cat("Plotting demography + covariate vs time grid\n")
                 self$gridResults$plottingDemographicGridCovariate[[self$jobName]] <- plotDemographicGridCovariateQuantiles(summStat, inputs$gridPoints, "Time", inputs$covariate, self$attributes$covariate, self$jobName, self$attributes, self$actions)
               }
               if (self$plottingFlags$plottingDemographicGridCovariates) {
                 cat("Plotting covariates\n")
                 # print(self$attributes$covariates)
                 for (cov in self$attributes$covariates) {
                   cat("plotting", cov)
                   self$gridResults$plottingDemographicGridCovariates[[cov]] <- plotDemographicGridCovariateQuantiles(summStat, inputs$gridPoints, "Time", inputs$covariates[[cov]], cov, self$jobName, self$attributes, self$actions)
                     # plotDemographicGridCovariateQuantiles(summStat, inputs$gridPoints, "GridPoints", cov, self$jobName)
                 }
                 # self$gridResults$plottingDemographicGridCovariates[[self$jobName]] <- plotDemographicGridCovariatesQuantiles(summStat, inputs$gridPoints, "GridPoints", inputs$covariates, self$jobName)
               }
               if (self$plottingFlags$plottingDemographicMeanCovariate) {
                 self$data <- self$data %>% dplyr::select(-contains("PopSize"))
                 self$data <- self$data %>%
                   rename_with(~ str_replace(., "gmrf.mean", "PopSize"))
                 self$actions$logPop <- FALSE
                 # self$data <- self$data %>%
                 #   mutate(across(contains("PopSize"), ~ . - gp.mean))
                 self$data <- self$data %>%
                   rowwise() %>%
                   mutate(
                     popsize_mean = mean(c_across(contains("PopSize"))),
                     popsize_sd = sd(c_across(contains("PopSize")))
                   ) %>%
                   mutate(across(
                     contains("PopSize"),
                     ~ (. - popsize_mean)
                   )) %>%
                   ungroup() %>%
                   dplyr::select(-popsize_mean, -popsize_sd)  # clean up helper columns
                 summStatMeanGmrf <- self$summStatCalculator(self$data)
                 cat("Plotting demography Mean vs covariate\n")
                 self$gridResults$plottingDemographicMeanCovariate[[self$jobName]] <- plotDemographicQuantiles(summStatMeanGmrf, inputs$covariate, self$attributes$covariate, self$jobName, self$attributes, self$actions)
               }
               return(self$gridResults)
             },
             
             inputsSetter = function() { 
               var_names <- c("gridPoints")
               inputs <- setNames(vector("list", length(var_names)), var_names)
               #cat(self$path_to_job)
               inputFilePath <- file.path(self$path_to_job, "inputs.txt")
               if (file.exists(inputFilePath) && self$actions$useInputFile) { 
                 cat("input file found \n")
                 inputFile <- readLines(inputFilePath)
                 for (var in var_names) {
                   ## TODO ADD FUNCTION EXTRACT VECTOR??? OK IF IT IS IN OPEN DATA
                   inputs[[var]] <- extract_vector(inputFile, var)
                 }
                 cat("end InputsSetter\n")
               } else {
                 cat("input file not found; setting inputs based on functions\n")
                 inputs$gridPoints <- self$loadGridPoints()
                 
                 inputs$covariate <- self$loadCovariate()
                 inputs$covariates <- self$loadCovariates()
                 cat("end InputsSetter\n")
               return(inputs)
               }
             }, 
             
             loadGridPoints = function() {
               cat("Loading gridPoints of length ")
               # TODO correct, at the beginning I added a gridPoint=0 to make it 60.
               # gridPoints <- "0 0.043835616438173 0.128767123287616 0.20547945205476 0.290410958903976 0.37534246575342 0.457534246575278 0.542465753424494 0.62465753424658 0.709589041095796 0.794520547945012 0.876712328767098 0.961643835616314 1.04383561643817 1.12876712328762 1.20547945205476 1.29041095890398 1.37534246575342 1.45753424657528 1.54246575342449 1.62465753424658 1.7095890410958 1.79452054794501 1.8767123287671 1.96164383561631 2.04383561643817 2.12876712328762 2.20547945205476 2.29041095881735 2.37511041236939 2.45707762548409 2.54177707903591 2.6237442921506 2.70844374570265 2.79314319925447 2.87511041236939 2.95980986592122 3.04177707903591 3.12647653258796 3.20571150526553 3.29041095890398 3.37534246575342 3.45753424657528 3.54246575342449 3.62465753424658 3.7095890410958 3.79452054794501 3.8767123287671 3.96164383561631 4.04383561643817 4.12876712328762 4.20547945205476 4.29041095890398 4.37534246575342 4.45753424657528 4.54246575342449 4.62465753424658 4.7095890410958 4.79452054794501 4.8767123287671" |> 
               if (self$attributes$tree == "YF") {   
                 # gridPoints <- "0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.4 0.45 0.5 0.55 0.6 0.65 0.7 0.75 0.8 0.85 0.9 0.95 1 1.05 1.1 1.15 1.2 1.25 1.3 1.35 1.4 1.45 1.5 1.55 1.6 1.65 1.7 1.75 1.8 1.85 1.9 1.95 2 2.05 2.1 2.15 2.2 2.25 2.3 2.35 2.4 2.45 2.5 2.55 2.6 2.65 2.7 2.75 2.8 2.85 2.9 2.95 3"
                 gridPoints <- "0.043835616438173 0.128767123287616 0.20547945205476 0.290410958903976 0.37534246575342 0.457534246575278 0.542465753424494 0.62465753424658 0.709589041095796 0.794520547945012 0.876712328767098 0.961643835616314 1.04383561643817 1.12876712328762 1.20547945205476 1.29041095890398 1.37534246575342 1.45753424657528 1.54246575342449 1.62465753424658 1.7095890410958 1.79452054794501 1.8767123287671 1.96164383561631 2.04383561643817 2.12876712328762 2.20547945205476 2.29041095881735 2.37511041236939 2.45707762548409 2.54177707903591 2.6237442921506 2.70844374570265 2.79314319925447 2.87511041236939 2.95980986592122 3.04177707903591 3.12647653258796 3.20571150526553 3.29041095890398 3.37534246575342 3.45753424657528 3.54246575342449 3.62465753424658 3.7095890410958 3.79452054794501 3.8767123287671 3.96164383561631 4.04383561643817 4.12876712328762 4.20547945205476 4.29041095890398 4.37534246575342 4.45753424657528 4.54246575342449 4.62465753424658 4.7095890410958 4.79452054794501 4.8767123287671 5.00"
                 mrsd <- as.Date("2019-02-24")
                 mrsd_decimal_years <- decimal_date(mrsd)
                 gridPoints <- mrsd_decimal_years - as.numeric(strsplit(gridPoints, " ")[[1]]) 
                } else if (self$attributes$tree == "Dengue") {
                 gridPoints <- "0.083 0.167 0.250 0.333 0.417 0.500 0.583 0.667 0.750 0.833 0.917 1.000 1.083 1.167 1.250 1.333 1.417 1.500 1.583 1.667 1.750 1.833 1.917 2.000 2.083 2.167 2.250 2.333 2.417 2.500 2.583 2.667 2.750 2.833 2.917 3.000 3.083 3.167 3.250 3.333 3.417 3.500 3.583 3.667 3.750 3.833 3.917 4.000 4.083 4.167 4.250 4.333 4.417 4.500 4.583 4.667 4.750 4.833 4.917 5.000 5.083 5.167 5.250 5.333 5.417 5.500 5.583 5.667 5.750 5.833 5.917 6.000 6.083 6.167 6.250 6.333 6.417 6.500 6.583 6.667 6.750 6.833 6.917 7.000 7.083 7.167 7.250 7.333 7.417 7.500 7.583 7.667 7.750 7.833 7.917 8.000 8.083 8.167 8.250 8.333 8.417 8.500 8.583 8.667 8.750 8.833 8.917 9.000 9.083 9.167 9.250 9.333 9.417 9.500 9.583 9.667 9.750 9.833 9.917 10.000 10.083 10.167 10.250 10.333 10.417 10.500 10.583 10.667 10.750 10.833 10.917 11.000 11.083 11.167 11.250 11.333 11.417 11.500 11.583 11.667 11.750 11.833 11.917 12.000 12.083 12.167 12.250 12.333 12.417 12.500 12.583 12.667 12.750 12.833 12.917 13.000 13.083 13.167 13.250 13.333 13.417 13.500 13.583 13.667 13.750 13.833 13.917 14.000 14.083 14.167 14.250 14.333 14.417 14.500 14.583 14.667 14.750 14.833 14.917 15.000 15.083 15.167 15.250 15.333 15.417 15.500 15.583 15.667 15.750 15.833 15.917 16.000 16.083 16.167 16.250 16.333 16.417 16.500 16.583 16.667 16.750 16.833 16.917 17.000 17.2" # added 1
               } else if (self$attributes$tree == "Mox") {
                 gridPoints <- "3000 6000 9000 12000 15000 18000 21000 24000 27000 30000 33000 36000 39000 42000 45000 48000 51000 54000 57000 60000 63000 66000 69000 72000 75000 78000 81000 84000 87000 90000 93000 96000 99000 102000 105000 108000 111000 114000 117000 120000 123000 126000 129000 132000" 
                 gridPoints <- as.numeric(strsplit(gridPoints, " ")[[1]]) 
                 # |> sort(decreasing = TRUE)
                } else if (self$attributes$tree == "Rabies") {
                 gridPoints <- "4.950000 5.116667 5.200000 5.366667 6.283333 6.450000 6.950000 7.200000 7.283333 7.366667 7.450000 7.533333 7.700000 7.783333 8.033333 8.116667 8.200000 8.283333 8.366667 8.450000 8.533333 8.616667 8.700000 8.783333 8.866667 8.950000 9.033333 9.116667 9.200000 9.283333 9.366667 9.450000 9.533333 9.616667 9.700000 9.783333 9.866667 9.950000 10.033333 10.116667 10.200000 10.283333 10.366667 10.450000 10.533333 10.616667 10.700000 10.783333 10.866667 10.950000 11.033333 11.116667 11.200000 11.283333 11.366667 11.450000 11.533333 11.616667 11.700000 11.783333 11.866667 11.950000 12.033333 12.116667 12.200000 12.283333 12.366667 12.450000 12.533333 12.616667 12.700000 12.866667 12.950000 13.033333 13.116667 13.200000 13.283333 13.366667 13.450000 13.533333 13.616667 13.700000 13.783333 13.866667 13.950000 14.033333 14.116667 14.200000 14.283333 14.366667 14.533333 14.700000 14.783333 14.866667 14.950000 15.033333 15.116667 15.200000 15.366667 15.450000 15.533333 15.616667 15.700000 15.783333 15.950000 16.033333 16.116667 16.200000 16.283333 16.366667 16.450000 16.533333 16.616667 16.783333 16.866667 17.033333 17.366667 17.450000 17.533333 17.616667 17.783333 17.866667 18.033333 18.116667 18.283333 18.366667 18.533333 18.616667 18.700000 19.033333 19.116667 19.366667 19.450000 19.533333 19.616667 19.866667 19.950000 20.116667 20.200000 20.283333 20.366667 20.450000 20.533333 20.616667 20.700000 20.783333 20.950000 21.200000 21.283333 21.450000 21.533333 21.616667 21.700000 21.783333 22.033333 22.200000 22.283333 22.366667 22.450000 22.533333 22.616667 22.700000 22.950000 23.116667 23.200000 23.283333 23.366667 23.533333 23.616667 23.950000 24.033333 24.283333 24.866667 26.200000 27.00"
               } else if (self$attributes$tree == "Hiv") {
                 gridPoints <- "0.98 1.98 2.98 3.98 4.98 5.98 6.98 7.98 8.98 9.98 10.98 11.98 12.98 13.98 14.98 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31"
               }
              if (!is.numeric(gridPoints)) gridPoints <- self$strToNum(gridPoints)
              cat("There are ", length(gridPoints), "grid points...\n")

              return(gridPoints)
             }, 
             
             loadCovariate = function() {
               cat("Loading covariate ")
               if (self$attributes$tree == "YF") {
               # if (self$attributes$covariate == "Temperature") {
                 covariate = "0.3027211 0.4823447 0.7165678 1.534038 0.8174045 -0.1073073 -0.6599293 -1.170085 -2.4373 -2.00494 -1.771272 -1.050823 -0.2078454 0.5861498 0.04260229 0.446758 0.1998386 -0.3978539 0.1405105 -0.5242016 -1.733764 -2.607336 -1.57242 -1.149146 -0.1867545 0.3509135 0.7262176 0.9908103 0.6181554 0.1829303 0.2483409 0.1805948 -0.4508953 -0.9323415 -1.186877 -0.2391121 0.9106503 0.9733064 1.237353 0.72159 1.166837 1.305599 1.496124 1.267496 0.3240997 -0.1700388 -0.4288255 -0.3188713 0.3625393 0.5279674 0.8166514 1.448761 0.6148908 0.6079989 1.111351 0.8490195 -0.4291002 -1.223232 -0.8986986 -0.4501623"
                 self$attributes$covariate <- "Temperature"
                 # covariate = self$strToNum(covariate)
                # } 
               #   else if ( self$attributes$covariate == "ExpTemperature") {
               #   covariate = "0.3027211 0.4823447 0.7165678 1.534038 0.8174045 -0.1073073 -0.6599293 -1.170085 -2.4373 -2.00494 -1.771272 -1.050823 -0.2078454 0.5861498 0.04260229 0.446758 0.1998386 -0.3978539 0.1405105 -0.5242016 -1.733764 -2.607336 -1.57242 -1.149146 -0.1867545 0.3509135 0.7262176 0.9908103 0.6181554 0.1829303 0.2483409 0.1805948 -0.4508953 -0.9323415 -1.186877 -0.2391121 0.9106503 0.9733064 1.237353 0.72159 1.166837 1.305599 1.496124 1.267496 0.3240997 -0.1700388 -0.4288255 -0.3188713 0.3625393 0.5279674 0.8166514 1.448761 0.6148908 0.6079989 1.111351 0.8490195 -0.4291002 -1.223232 -0.8986986 -0.4501623"
               #   covariate <- exp(self$strToNum(covariate))
               # } else {
               #   stop("Covariate not recognized")
               # }
               } else if (self$attributes$tree == "Dengue") {
                 covariate <- "3.13549421592915 2.77258872223978 2.484906649788 3.58351893845611 3.40119738166216 2.19722457733622 1.79175946922805 0.693147180559945 1.79175946922805 2.07944154167984 2.07944154167984 1.38629436111989 3.29583686600433 3.55534806148941 2.39789527279837 2.39789527279837 2.89037175789616 2.70805020110221 2.39789527279837 1.6094379124341 1.38629436111989 1.6094379124341 1.6094379124341 1.38629436111989 1.79175946922805 1.09861228866811 2.30258509299405 2.30258509299405 2.19722457733622 1.09861228866811 1.6094379124341 1.38629436111989 1.09861228866811 2.19722457733622 1.38629436111989 2.484906649788 2.89037175789616 3.3322045101752 2.56494935746154 3.61091791264422 3.36729582998647 3.63758615972639 3.09104245335832 2.83321334405622 1.6094379124341 0.693147180559945 2.07944154167984 2.39789527279837 2.07944154167984 2.30258509299405 3.09104245335832 2.484906649788 1.79175946922805 2.07944154167984 1.6094379124341 0 1.38629436111989 0 0.693147180559945 0.693147180559945 1.38629436111989 1.79175946922805 2.39789527279837 2.07944154167984 2.77258872223978 3.04452243772342 1.94591014905531 1.6094379124341 1.6094379124341 0.693147180559945 1.94591014905531 2.19722457733622 2.56494935746154 3.3322045101752 3.29583686600433 2.39789527279837 2.19722457733622 1.79175946922805 2.56494935746154 1.38629436111989 0 1.38629436111989 1.09861228866811 1.38629436111989 2.19722457733622 2.89037175789616 2.19722457733622 2.30258509299405 1.94591014905531 1.38629436111989 0.693147180559945 0 0 0.693147180559945 0.693147180559945 1.6094379124341 2.19722457733622 2.39789527279837 2.56494935746154 2.77258872223978 0 1.79175946922805 1.09861228866811 0.693147180559945 0.693147180559945 1.09861228866811 0.693147180559945 1.09861228866811 2.07944154167984 2.89037175789616 3.13549421592915 3.40119738166216 3.66356164612965 2.77258872223978 2.19722457733622 1.6094379124341 1.79175946922805 1.94591014905531 1.79175946922805 1.79175946922805 1.38629436111989 1.38629436111989 1.38629436111989 1.09861228866811 1.79175946922805 2.99573227355399 2.77258872223978 2.19722457733622 1.6094379124341 2.39789527279837 2.83321334405622 2.56494935746154 2.56494935746154 3.36729582998647 2.94443897916644 3.85014760171006 4.00733318523247 3.04452243772342 2.30258509299405 1.09861228866811 0 0 0 0 0 1.09861228866811 0 2.07944154167984 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.693147180559945 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1.6094379124341 2.30258509299405 3.85014760171006 3.80666248977032 3.80666248977032 4.34380542185368 4.40671924726425 3.43398720448515 2.99573227355399 3.40119738166216 3.85014760171006 3.73766961828337 4.20469261939097 3.40119738166216 2.70805020110221 0 0 0 0 0 0 0 0 0 0"
                 self$attributes$covariate <- "Log isolate"
                 
               } else if (self$attributes$tree == "Mox") {
                 covariate <- "-34.9829237435009 -34.8111326034063 -34.7875697865353 -35.905 -38.2792083333333 -39.5028248587571 -40.6432283464567 -41.2097 -40.3944859813084 -41.1308333333333 -40.1056382978723 -39.3101020408163 -40.5629166666667 -40.0034722222222 -38.4827906976744 -39.7815625 -38.5078378378378 -38.8043333333333 -38.3958064516129 -40.45175 -40.8091176470588 -41.6965517241379 -39.7752777777778 -39.6125 -38.4489743589744 -39.1734285714286 -37.5202325581395 -37.0368292682927 -39.4696153846154 -38.4703333333333 -39.5370833333333 -38.9754166666667 -38.2776923076923 -37.1614285714286 -36.7815384615385 -37.5169565217391 -38.5457894736842 -37.7031578947368 -34.2303846153846 -34.892380952381 -35.9095 -37.000625 -32.8695 -33.4352631578947"
                  self$attributes$covariate <- "D18"
               } else if (self$attributes$tree == "Hiv") {
                 covariate <- "0.52 0.55 0.58 0.62 0.65 0.68 0.71 0.74 0.76 0.76 0.75 0.73 0.70 0.65 0.60 0.6 0.56 0.556 0.5556 0.55556 0.555556 0.5555556 0.46 0.446 0.4446 0.36 0.336 0.3336 0.26 0.226 0.2226"
                 self$attributes$covariate <- "Incidence"
               } else if (self$attributes$tree == "Rabies") {
                 covariate <- "1.114561 1.098838 1.093379 1.091787 1.071138 1.069841 1.05078 1.041594 1.040048 1.032361 1.018202 1.013034 1.011396 1.007029 1.002546 1.000147 0.9963444 0.9913218 0.9869364 0.9813094 0.9811141 0.970348 0.9675423 0.9536017 0.9497648 0.9458735 0.9431793 0.9410588 0.9357116 0.9283985 0.9107743 0.8945917 0.8876499 0.8674496 0.8652943 0.8508734 0.8484066 0.8467113 0.8411978 0.8176164 0.8105638 0.8083608 0.8031166 0.7983723 0.7975313 0.7836496 0.7705004 0.7636063 0.7590418 0.7490625 0.7425462 0.7330549 0.7276156 0.7018544 0.6913908 0.6787084 0.6642289 0.6486335 0.6338092 0.6309491 0.6209658 0.6167374 0.6060042 0.5964287 0.5765011 0.534281 0.5234012 0.5116614 0.4884341 0.4737783 0.4363611 0.402292 0.3831165 0.3724192 0.3651238 0.3572934 0.347927 0.3281552 0.3016765 0.2759474 0.2649981 0.2349197 0.2290227 0.2250931 0.207001 0.1918936 0.1565255 0.1397983 0.1089248 0.09421988 0.06603497 0.06142002 0.06132955 0.06022541 0.05499863 0.04718939 0.04391261 0.01916822 0.01298569 0.005138362 0.0001860512 -0.006168088 -0.02802554 -0.03491981 -0.03635839 -0.03830851 -0.04972285 -0.07050142 -0.07062282 -0.07510568 -0.07772076 -0.09255032 -0.09777338 -0.115857 -0.1167593 -0.1196543 -0.1397349 -0.1470672 -0.1733158 -0.176696 -0.2151404 -0.2251329 -0.2282972 -0.2345488 -0.2451242 -0.25492 -0.2605699 -0.2700267 -0.2849537 -0.2931931 -0.2965522 -0.3284914 -0.3337404 -0.3502205 -0.3518351 -0.3795474 -0.391078 -0.4056395 -0.450724 -0.4611887 -0.5008314 -0.5555021 -0.5742275 -0.5920277 -0.6845344 -0.6945221 -0.7082625 -0.7516351 -0.7805634 -0.8731632 -1.065522 -1.137801 -1.19696 -1.304426 -1.347768 -1.454566 -1.470742 -1.533172 -1.560663 -1.615263 -1.715415 -1.810248 -1.851039 -1.90547 -1.98275 -2.173124 -2.223458 -2.382428 -2.438384 -2.521081 -2.583118 -2.890754 -3.197027 -3.251473 -3.704129"
                 # covariate <- "13.3589345588321 13.3398164421675 13.3331775177452 13.3312417122171 13.3061344714447 13.3045570393534 13.2813799435817 13.270210404609 13.2683301413029 13.2589832495123 13.2417675019414 13.2354826907946 13.2334916024019 13.2281811998815 13.2227298616201 13.2198131557253 13.2151897350748 13.2090824921895 13.2037500775153 13.1969080329123 13.1966705390042 13.1835795305845 13.1801680475979 13.1632170066242 13.1585516261277 13.1538199486164 13.1505439565462 13.147965638578 13.1414637503345 13.1325714057437 13.1111414585457 13.0914643391876 13.0830234465849 13.0584610506522 13.0558404053459 13.0383053701943 13.0353059120799 13.0332445704342 13.0265404143491 12.997866787188 12.989291241591 12.9866125430687 12.9802359375447 12.9744670731308 12.9734445458929 12.9565652324459 12.9405765568135 12.9321936666582 12.9266435472693 12.9145092277153 12.9065858030489 12.8950449961021 12.8884310863704 12.8571069570831 12.8443838823451 12.8289628094797 12.8113565618021 12.7923934198729 12.7743679911747 12.7708902718428 12.7587511632969 12.7536096289615 12.7405586751981 12.7289154538241 12.704684613334 12.6533474522183 12.6401182652118 12.6258433982097 12.5976003375138 12.5797797099037 12.5342826040566 12.4928564871934 12.4695402165157 12.4565329029999 12.4476621906038 12.4381408850742 12.4267518347971 12.4027105041171 12.370513983017 12.3392288527815 12.3259151900526 12.289341574121 12.2821711990901 12.2773929976648 12.2553940495191 12.2370243752559 12.1940188090595 12.1736794557046 12.136139122841 12.1182587884577 12.0839875731194 12.0783760658002 12.0782660634342 12.07692348261 12.0705680331016 12.0610724511875 12.0570880708725 12.0270003322226 12.019482744301 12.009940844794 12.0039191228897 11.9961928590343 11.9696154661266 11.9612324398825 11.9594832061727 11.9571119756995 11.9432328004922 11.9179672768345 11.9178196634738 11.9123687582911 11.9091889813168 11.8911570920474 11.8848061573167 11.8628175019184 11.8617204141403 11.8582002240352 11.8337834381267 11.8248677736244 11.7929510310408 11.7888408962254 11.7420946655413 11.7299444352689 11.7260967703111 11.718495176994 11.7056360847432 11.6937249723678 11.6868550407196 11.6753561960786 11.6572057581201 11.647187169602 11.6431026284526 11.604266505425 11.5978840330554 11.5778451134695 11.5758819165455 11.5421853196188 11.5281648632221 11.5104588253144 11.4556387299563 11.442914268023 11.3947110350267 11.3282346998173 11.3054656533021 11.2838216238662 11.1713389305947 11.1591944833189 11.1424869794081 11.0897483360245 11.0545732140253 10.9419772443938 10.7080801506313 10.6201931905805 10.5482594928338 10.417586951647 10.3648855089707 10.235025672112 10.2153557922833 10.1394454483102 10.1060178224629 10.0396274650126 9.91784765100671 9.8025364677003 9.75293730005124 9.68675211284726 9.59278465594327 9.36130094023264 9.30009770869846 9.10679897848963 9.03875956624429 8.93820508617861 8.86277198009567 8.4887048240548 8.11629404342885 8.0500915872195 7.49968778245124"
                 self$attributes$covariate <- "Cumulative area"
               }
               covariate = self$strToNum(covariate)
               # covariate <- rev(covariate)
               cat(self$attributes$covariate, "of length ", length(covariate), "...\n")
               return(covariate)
             }, 
             
             loadCovariates = function() {
               cat("Loading covariates...\n ")
               if (self$attributes$tree == "YF") {
               wind_speed <- "-1.21495193546687 -1.18995765152049 -1.67794232546881 -2.47978889173934 -1.58102665803561 -0.476802892787966 -0.287249757152151 -1.32714899462921 -1.55289630203912 -1.74540175135201 -1.63287249131896 -0.96861053883037 -1.42002049223164 -1.43909349429791 -0.613643321950706 -0.467455768203423 -0.0420017316812033 1.00538694439834 1.21003120826854 1.01763679690131 0.869293759854527 0.245067715864307 -0.32681891627314 -0.331312342828578 0.472271344599128 0.0662120321336072 0.0311365368327352 0.4773306655969 0.328195474785529 0.857531140706487 1.52785607535775 1.32942389567536 1.124882613598 0.608575875891813 -0.0343321527417374 -0.0984516393698958 -0.0718421582005949 0.113180549009037 -0.966565171210304 1.12174303125905 0.0662582168344767 0.11833606642669 1.68519321753467 0.795985190830701 0.895487268608187 0.359460828872532 0.910794655063725 0.225306415336793 -0.687555741767694 -0.848948958464176 -0.142760873942745 -0.490295011990894 0.487973585654273 0.4649523216237 1.77865056466139 1.80082230675424 0.899906117079809 0.660478468254862 0.319525219806477 0.240861861420581 " 
               relat_humid_percent_variable_name <- "1.16339175543323 1.34689207928182 1.21920552289544 0.925191854167221 0.669505071664894 1.20788970472181 1.41344907601414 1.28255896543112 1.12126058836625 0.63070511386886 1.02166622765233 0.825214035016609 0.946536753205201 0.899126307552142 0.861768429086707 0.666986292019333 0.783049520839661 0.495852736002261 -0.00933764371348475 -0.930367553485222 -0.0751234101703441 0.0908478964946127 0.387438863156261 0.704872803405544 0.507797782175022 0.291593746620178 0.167219048196912 -0.0399223210609458 0.430536964525504 0.389697349216163 -0.118301423173365 -1.02411010028948 -1.06779352134324 -0.878366699117546 0.0570764861538453 -0.168666017758637 -0.878044966339532 0.180857551641838 -0.0984760690849192 0.653826758612374 -0.0663277987785902 -0.221526242171522 -1.76857897884423 -1.93165407665931 -2.61873417986047 -1.07567218527407 -0.63135188407054 0.190984200640219 0.460977162709895 0.750477939050951 0.372677120414714 -0.892426211069696 0.236505830556613 0.000974690756390541 -2.44302255798152 -2.29398438252625 -2.13183407528696 -0.548380502235669 -0.521655544921697 -0.920953882328926 " 
               pre_mm_day_variable_name <- "0.712567205774826 0.953904202987002 1.31356770224851 1.48853664077397 0.49171515849256 0.638759349676205 0.91737426869539 0.374531532788107 -0.291334735371713 -0.766083021460178 0.0045541591102895 -0.263754420798476 0.236642189766956 1.01475331318316 0.994824318540383 1.18470815406046 0.935153696120041 0.861601031628383 0.228903045952325 -0.978598784995009 -0.741017948111311 -1.8344913253576 -0.915255080625345 0.0175580848987146 -0.17315498148415 0.415949701539888 0.414611393121688 0.531116880357681 0.906396211294621 1.04457415955189 0.413960135407642 -0.63891299157404 -0.996422681129147 -1.70783883044632 -0.252385705382114 -0.869531016529801 -0.946549062673652 0.573602168833686 0.348035864478264 1.47185142521916 0.834262057911938 0.774870998476478 -0.359908914488751 0.0425595725119446 -2.34252312531888 -1.35903250471142 -1.67333193781538 0.0160207706598638 0.24487565967341 1.00792657255227 1.05249190886834 0.133871720923578 0.88844087240046 1.11789461212328 -0.1520459338179 -1.12446728155356 -2.43742296103627 -0.410446980542886 -1.95391036254388 -1.41454615283557 " 
               evi_variable_name <- "1.32372030965187 1.83403834486577 1.76757623411013 1.62210616111416 1.33796541657477 1.55018674168887 0.645032356263322 0.623416620286522 0.398776270579122 0.267498765884541 0.26125214332034 0.555303129014217 0.67575552788959 0.759420502615642 0.475535772245904 0.508082230355223 0.544523367491533 0.178341778974525 -0.917772644610046 -1.18684648011232 -1.24882929411659 -0.676824403578208 -0.272900807685724 -0.0176134636869493 0.299434491280548 0.549172587037604 0.689824801444935 0.855851527247665 0.686718113678666 -0.0155447156570982 -1.0335032083237 -1.5391230319943 -1.42331077915839 -0.971824907854034 -0.526410071382706 -0.0945897492821621 0.211149645707306 0.664964402410646 0.885538789069972 0.92224528513757 0.631603214136835 -0.216738915827667 -1.23873966390964 -1.88424005826939 -1.56339051250957 -0.882298685135519 -0.246862220282986 0.40206545946465 0.531613500443179 0.686521365092588 0.714648578263581 0.5075069755369 0.51214060397271 -0.786252545648851 -2.05313240495035 -2.00188458008787 -1.81242544802911 -1.33175154977749 -0.834582074413167 -0.302138796567336 " 
               temp_celsius_variable_name <- "0.302721062365908 0.482344748487265 0.71656778286309 1.53403759952926 0.817404516337528 -0.10730732710368 -0.659929297681808 -1.17008455780511 -2.43730046354652 -2.00494002302965 -1.77127192802424 -1.05082341746693 -0.207845438234293 0.586149793180624 0.0426022856972311 0.446758016858998 0.199838580566488 -0.39785389171922 0.140510454041102 -0.524201595251857 -1.73376400556605 -2.60733552033162 -1.57241976800754 -1.14914646336238 -0.186754519923211 0.350913537396001 0.726217609503476 0.99081034597048 0.618155376912772 0.182930251638331 0.248340884207028 0.180594803007582 -0.450895264757284 -0.932341525345489 -1.18687739211217 -0.239112061049147 0.910650257327585 0.973306448273949 1.23735322237016 0.721589993295889 1.16683673819061 1.3055988427665 1.49612426205878 1.26749560367613 0.324099721325033 -0.170038766388812 -0.428825458061236 -0.318871279924323 0.362539297787331 0.527967444941775 0.816651449145483 1.44876144430791 0.614890776288627 0.607998896450517 1.11135138614553 0.84901945437196 -0.429100162731543 -1.2232318528406 -0.898698624920965 -0.450162282101263 " 
               long_wave_radiation <- "0.812255994102679 0.866164499444966 0.827907912015215 0.679374119883235 0.537876501697654 0.909853288488253 1.00429540027743 0.772349410222417 0.754790458681822 0.348004457317605 0.692702191224393 0.31215267615277 0.387324845079481 0.626783907338642 0.638201596088388 0.625279267407317 0.644188804598229 0.532358200893016 0.203965021536296 -2.4061140846822 -0.161342982423935 -0.185186561235166 0.0738043320271245 0.478432162427485 0.485085579788689 0.216013702225068 0.241491090198703 0.145539057329282 0.500366033906681 0.544342532400132 0.336871640155572 -0.419278718279615 -0.489664301927466 -0.424557577772267 0.121049759857373 0.140251287682838 -0.262131742580281 0.333292287228718 0.16709677336873 0.793042919931348 0.260393237078153 0.258725286402964 -0.865763346724695 -0.878472777415527 -3.88644255910488 -0.221370643813714 -0.00580506606525179 0.26022597668566 0.415194270705225 0.611397857931142 0.43678102807945 -0.36050838098809 0.463881457168909 0.415239890566046 -2.65199401656777 -2.35832775165555 -3.23796914694545 -0.0533042337026119 -0.304170077737805 -0.701942745972814 " 
               peanut_planting_proportion <- "-0.693620340834774 -0.693620340834774 -0.693620340834774 -0.693620340834774 1.4929807953722 2.04522469511636 2.04522469511636 -0.693620340834774 -0.693620340834774 -0.693620340834774 -0.693620340834774 -0.693620340834774 -0.693620340834774 -0.693620340834774 0.781710160756411 0.908501300482927 1.60977702719488 -0.0497083606383063 -0.25249529646711 -0.693620340834774 -0.693620340834774 -0.693620340834774 -0.693620340834774 -0.693620340834774 1.26212283468858 1.00271783564239 1.11109525970477 1.17247005451214 1.45770093464751 -0.295983148758026 -0.299591083384016 -0.693620340834774 -0.693620340834774 -0.693620340834774 -0.693620340834774 -0.693620340834774 -0.693620340834774 -0.693620340834774 1.65681731809043 1.72643027343785 1.98027005733517 -0.270792840207123 -0.220536506940372 -0.693620340834774 -0.693620340834774 -0.693620340834774 -0.693620340834774 -0.693620340834774 -0.693620340834774 -0.693620340834774 1.73974189544212 1.7259422551493 2.04522469511636 -0.0496816678632112 -0.048451254330504 -0.693620340834774 -0.693620340834774 -0.693620340834774 -0.693620340834774 -0.693620340834774 " 
               rice_harvesting_proportion <- "1.39518021807135 1.39518021807135 1.39518021807135 0.0791443646227185 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 0.901227765519708 1.2996143390774 1.17672685880149 0.94925576698438 0.0798719814979042 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 1.11756172005226 1.09369773457727 1.02409402086324 1.18108707609723 1.17089009160908 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 1.29321873598917 1.28349132192647 1.28583431497897 1.29236442834464 1.27409159661185 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 0.970711731860549 1.39518021807135 1.39518021807135 1.39518021807135 1.33398540043502 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 1.39518021807135 " 
               covariateCollection <- tibble(
                 wind_speed = self$strToNum(wind_speed),
                 relat_humid_percent_variable_name = self$strToNum(relat_humid_percent_variable_name),
                 pre_mm_day_variable_name = self$strToNum(pre_mm_day_variable_name),
                 evi_variable_name = self$strToNum(evi_variable_name),
                 temp_celsius_variable_name = self$strToNum(temp_celsius_variable_name),
                 long_wave_radiation = self$strToNum(long_wave_radiation),
                 peanut_planting_proportion = self$strToNum(peanut_planting_proportion),
                 rice_harvesting_proportion = self$strToNum(rice_harvesting_proportion)
               )
               } else {
                 covariateCollection <- tibble(self$attributes$covariate)
               }
               return(covariateCollection)
             }
               
           )
)



# ---- DataToPlotBirthDeath ----
DataToPlotNPBD <- 
  R6Class("DataToPlotNPBD",
          inherit = DataToPlot,
          public = list(
            initialize = function(data, path, jobName = NULL, attributes = list(),
                                  plottingFlags = list(), actions = list(), gridResults = NULL) {
              defaultsPlotting <- list(
                plottingBirthRatesGrid = FALSE, 
                plottingBirthRateCovariate = FALSE
              )
              plottingFlags <- modifyList(defaultsPlotting, plottingFlags)
              # defaultsActions <- list(
              #   logPop = FALSE,
              #   publicationQuality = FALSE
              # )
              # actions <- modifyList(defaultsActions, actions)
              super$initialize(data = data, path = path, jobName = jobName, attributes = attributes, 
                               plottingFlags = plottingFlags, actions = actions, gridResults = gridResults)
              
            },
            
            plotCreator = function() {
              cat("DataToPlotNPBD\n")

              if (self$actions$logRates) {
                self$data <- self$data %>%
                  mutate(across(contains("birthRate"), log))
              }
              
              self$data <- self$data %>%  dplyr::select(contains("birthRateDelta"))
              
              
              summStat <- self$summStatCalculator(self$data)
              inputs <- self$inputsSetter()
              if (self$plottingFlags$plottingBirthRatesCovariate) {
                cat("Plotting Rates vs Covariate\n")
                print(inputs$covariate)
                print(summStat)
                self$gridResults$plottingBirthRatesCovariate[[self$jobName]] <- plottingBirthRatesQuantiles(summStat, inputs$covariate, self$attributes$covariate, self$jobName, self$actions)
              }
              
              if (self$plottingFlags$plottingBirthRatesGrid) {
                cat("Plotting grid\n")
                self$gridResults$plottingBirthRatesGrid[[self$jobName]] <- plottingBirthRatesGrid(summStat, inputs$gridPoints, "Time", inputs$covariate, 
                                         self$attributes$covariate, self$jobName, self$actions)
              }
              
              return(self$gridResults)
            },
            
            inputsSetter = function() { 
              var_names <- c("gridPoints")
              inputs <- setNames(vector("list", length(var_names)), var_names)
              #cat(self$path_to_job)
              inputFilePath <- file.path(self$path_to_job, "inputs.txt")
              if (file.exists(inputFilePath)) { 
                cat("input file found \n")
                inputFile <- readLines(inputFilePath)
                for (var in var_names) {
                  ## TODO ADD FUNCTION EXTRACT VECTOR??? OK IF IT IS IN OPEN DATA
                  inputs[[var]] <- extract_vector(inputFile, var)
                }
                cat("end InputsSetter\n")
              } else {
                cat("input file not found; setting inputs based on functions\n")
                inputs$gridPoints <- self$loadGridPoints()
                inputs$covariate <- self$loadCovariate()
                inputs$covariates <- self$loadCovariates()
                cat("end InputsSetter\n")
                return(inputs)
              }
            }, 
            
            loadGridPoints = function() {
              cat("Loading gridPoints: ")
              # gridPoints <- "0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.4 0.45 0.5 0.55 0.6 0.65 0.7 0.75 0.8 0.85 0.9 0.95 1 1.05 1.1 1.15 1.2 1.25 1.3 1.35 1.4 1.45 1.5 1.55 1.6 1.65 1.7 1.75 1.8 1.85 1.9 1.95 2 2.05 2.1 2.15 2.2 2.25 2.3 2.35 2.4 2.45 2.5 2.55 2.6 2.65 2.7 2.75 2.8 2.85 2.9 2.95 3"
              gridPoints <- seq(from = 0, to = 6, length.out =60)
              return(gridPoints)
            }, 
            
            loadCovariate = function() {
              cat("Loading covariate: ")
              if (self$attributes$covariate == "Temperature") {
                covariate = "0.3027211 0.4823447 0.7165678 1.534038 0.8174045 -0.1073073 -0.6599293 -1.170085 -2.4373 -2.00494 -1.771272 -1.050823 -0.2078454 0.5861498 0.04260229 0.446758 0.1998386 -0.3978539 0.1405105 -0.5242016 -1.733764 -2.607336 -1.57242 -1.149146 -0.1867545 0.3509135 0.7262176 0.9908103 0.6181554 0.1829303 0.2483409 0.1805948 -0.4508953 -0.9323415 -1.186877 -0.2391121 0.9106503 0.9733064 1.237353 0.72159 1.166837 1.305599 1.496124 1.267496 0.3240997 -0.1700388 -0.4288255 -0.3188713 0.3625393 0.5279674 0.8166514 1.448761 0.6148908 0.6079989 1.111351 0.8490195 -0.4291002 -1.223232 -0.8986986 -0.4501623"
                covariate = self$strToNum(covariate)
              } else if ( self$attributes$covariate == "ExpTemperature") {
                covariate = "0.3027211 0.4823447 0.7165678 1.534038 0.8174045 -0.1073073 -0.6599293 -1.170085 -2.4373 -2.00494 -1.771272 -1.050823 -0.2078454 0.5861498 0.04260229 0.446758 0.1998386 -0.3978539 0.1405105 -0.5242016 -1.733764 -2.607336 -1.57242 -1.149146 -0.1867545 0.3509135 0.7262176 0.9908103 0.6181554 0.1829303 0.2483409 0.1805948 -0.4508953 -0.9323415 -1.186877 -0.2391121 0.9106503 0.9733064 1.237353 0.72159 1.166837 1.305599 1.496124 1.267496 0.3240997 -0.1700388 -0.4288255 -0.3188713 0.3625393 0.5279674 0.8166514 1.448761 0.6148908 0.6079989 1.111351 0.8490195 -0.4291002 -1.223232 -0.8986986 -0.4501623"
                covariate <- exp(self$strToNum(covariate))
              } else if (self$attributes$covariate=="trueValues") {
                covariate ="0.9613785 -0.8194049 0.1246409 -0.3370856 -0.2272680 0.3346308 0.9370762 -0.3637770 -0.3158599"
                # covariate="0.8629017 -1.2465532 -1.1551631 -1.4893709 -1.4601220 -0.8197981 0.7786215 -1.4917432 -1.4861622"
                covariate = self$strToNum(covariate)
              } else {
                stop("Covariate not recognized")
              }
              return(covariate)
            }, 
            
            loadCovariates = function() {
              cat("Loading covariates: ")
              wind_speed <- "-1.21495193546687 -1.18995765152049 -1.67794232546881 -2.47978889173934 -1.58102665803561 -0.476802892787966 -0.287249757152151 -1.32714899462921 -1.55289630203912 -1.74540175135201 -1.63287249131896 -0.96861053883037 -1.42002049223164 -1.43909349429791 -0.613643321950706 -0.467455768203423 -0.0420017316812033 1.00538694439834 1.21003120826854 1.01763679690131 0.869293759854527 0.245067715864307 -0.32681891627314 -0.331312342828578 0.472271344599128 0.0662120321336072 0.0311365368327352 0.4773306655969 0.328195474785529 0.857531140706487 1.52785607535775 1.32942389567536 1.124882613598 0.608575875891813 -0.0343321527417374 -0.0984516393698958 -0.0718421582005949 0.113180549009037 -0.966565171210304 1.12174303125905 0.0662582168344767 0.11833606642669 1.68519321753467 0.795985190830701 0.895487268608187 0.359460828872532 0.910794655063725 0.225306415336793 -0.687555741767694 -0.848948958464176 -0.142760873942745 -0.490295011990894 0.487973585654273 0.4649523216237 1.77865056466139 1.80082230675424 0.899906117079809 0.660478468254862 0.319525219806477 0.240861861420581 " 
              relat_humid_percent_variable_name <- "1.16339175543323 1.34689207928182 1.21920552289544 0.925191854167221 0.669505071664894 1.20788970472181 1.41344907601414 1.28255896543112 1.12126058836625 0.63070511386886 1.02166622765233 0.825214035016609 0.946536753205201 0.899126307552142 0.861768429086707 0.666986292019333 0.783049520839661 0.495852736002261 -0.00933764371348475 -0.930367553485222 -0.0751234101703441 0.0908478964946127 0.387438863156261 0.704872803405544 0.507797782175022 0.291593746620178 0.167219048196912 -0.0399223210609458 0.430536964525504 0.389697349216163 -0.118301423173365 -1.02411010028948 -1.06779352134324 -0.878366699117546 0.0570764861538453 -0.168666017758637 -0.878044966339532 0.180857551641838 -0.0984760690849192 0.653826758612374 -0.0663277987785902 -0.221526242171522 -1.76857897884423 -1.93165407665931 -2.61873417986047 -1.07567218527407 -0.63135188407054 0.190984200640219 0.460977162709895 0.750477939050951 0.372677120414714 -0.892426211069696 0.236505830556613 0.000974690756390541 -2.44302255798152 -2.29398438252625 -2.13183407528696 -0.548380502235669 -0.521655544921697 -0.920953882328926 " 
              pre_mm_day_variable_name <- "0.712567205774826 0.953904202987002 1.31356770224851 1.48853664077397 0.49171515849256 0.638759349676205 0.91737426869539 0.374531532788107 -0.291334735371713 -0.766083021460178 0.0045541591102895 -0.263754420798476 0.236642189766956 1.01475331318316 0.994824318540383 1.18470815406046 0.935153696120041 0.861601031628383 0.228903045952325 -0.978598784995009 -0.741017948111311 -1.8344913253576 -0.915255080625345 0.0175580848987146 -0.17315498148415 0.415949701539888 0.414611393121688 0.531116880357681 0.906396211294621 1.04457415955189 0.413960135407642 -0.63891299157404 -0.996422681129147 -1.70783883044632 -0.252385705382114 -0.869531016529801 -0.946549062673652 0.573602168833686 0.348035864478264 1.47185142521916 0.834262057911938 0.774870998476478 -0.359908914488751 0.0425595725119446 -2.34252312531888 -1.35903250471142 -1.67333193781538 0.0160207706598638 0.24487565967341 1.00792657255227 1.05249190886834 0.133871720923578 0.88844087240046 1.11789461212328 -0.1520459338179 -1.12446728155356 -2.43742296103627 -0.410446980542886 -1.95391036254388 -1.41454615283557 " 
              evi_variable_name <- "1.32372030965187 1.83403834486577 1.76757623411013 1.62210616111416 1.33796541657477 1.55018674168887 0.645032356263322 0.623416620286522 0.398776270579122 0.267498765884541 0.26125214332034 0.555303129014217 0.67575552788959 0.759420502615642 0.475535772245904 0.508082230355223 0.544523367491533 0.178341778974525 -0.917772644610046 -1.18684648011232 -1.24882929411659 -0.676824403578208 -0.272900807685724 -0.0176134636869493 0.299434491280548 0.549172587037604 0.689824801444935 0.855851527247665 0.686718113678666 -0.0155447156570982 -1.0335032083237 -1.5391230319943 -1.42331077915839 -0.971824907854034 -0.526410071382706 -0.0945897492821621 0.211149645707306 0.664964402410646 0.885538789069972 0.92224528513757 0.631603214136835 -0.216738915827667 -1.23873966390964 -1.88424005826939 -1.56339051250957 -0.882298685135519 -0.246862220282986 0.40206545946465 0.531613500443179 0.686521365092588 0.714648578263581 0.5075069755369 0.51214060397271 -0.786252545648851 -2.05313240495035 -2.00188458008787 -1.81242544802911 -1.33175154977749 -0.834582074413167 -0.302138796567336 " 
              temp_celsius_variable_name <- "0.302721062365908 0.482344748487265 0.71656778286309 1.53403759952926 0.817404516337528 -0.10730732710368 -0.659929297681808 -1.17008455780511 -2.43730046354652 -2.00494002302965 -1.77127192802424 -1.05082341746693 -0.207845438234293 0.586149793180624 0.0426022856972311 0.446758016858998 0.199838580566488 -0.39785389171922 0.140510454041102 -0.524201595251857 -1.73376400556605 -2.60733552033162 -1.57241976800754 -1.14914646336238 -0.186754519923211 0.350913537396001 0.726217609503476 0.99081034597048 0.618155376912772 0.182930251638331 0.248340884207028 0.180594803007582 -0.450895264757284 -0.932341525345489 -1.18687739211217 -0.239112061049147 0.910650257327585 0.973306448273949 1.23735322237016 0.721589993295889 1.16683673819061 1.3055988427665 1.49612426205878 1.26749560367613 0.324099721325033 -0.170038766388812 -0.428825458061236 -0.318871279924323 0.362539297787331 0.527967444941775 0.816651449145483 1.44876144430791 0.614890776288627 0.607998896450517 1.11135138614553 0.84901945437196 -0.429100162731543 -1.2232318528406 -0.898698624920965 -0.450162282101263 " 
              long_wave_radiation <- "0.812255994102679 0.866164499444966 0.827907912015215 0.679374119883235 0.537876501697654 0.909853288488253 1.00429540027743 0.772349410222417 0.754790458681822 0.348004457317605 0.692702191224393 0.31215267615277 0.387324845079481 0.626783907338642 0.638201596088388 0.625279267407317 0.644188804598229 0.532358200893016 0.203965021536296 -2.4061140846822 -0.161342982423935 -0.185186561235166 0.0738043320271245 0.478432162427485 0.485085579788689 0.216013702225068 0.241491090198703 0.145539057329282 0.500366033906681 0.544342532400132 0.336871640155572 -0.419278718279615 -0.489664301927466 -0.424557577772267 0.121049759857373 0.140251287682838 -0.262131742580281 0.333292287228718 0.16709677336873 0.793042919931348 0.260393237078153 0.258725286402964 -0.865763346724695 -0.878472777415527 -3.88644255910488 -0.221370643813714 -0.00580506606525179 0.26022597668566 0.415194270705225 0.611397857931142 0.43678102807945 -0.36050838098809 0.463881457168909 0.415239890566046 -2.65199401656777 -2.35832775165555 -3.23796914694545 -0.0533042337026119 -0.304170077737805 -0.701942745972814 " 
              peanut_planting_proportion <- "-0.693620340834774 -0.693620340834774 -0.693620340834774 -0.693620340834774 1.4929807953722 2.04522469511636 2.04522469511636 -0.693620340834774 -0.693620340834774 -0.693620340834774 -0.693620340834774 -0.693620340834774 -0.693620340834774 -0.693620340834774 0.781710160756411 0.908501300482927 1.60977702719488 -0.0497083606383063 -0.25249529646711 -0.693620340834774 -0.693620340834774 -0.693620340834774 -0.693620340834774 -0.693620340834774 1.26212283468858 1.00271783564239 1.11109525970477 1.17247005451214 1.45770093464751 -0.295983148758026 -0.299591083384016 -0.693620340834774 -0.693620340834774 -0.693620340834774 -0.693620340834774 -0.693620340834774 -0.693620340834774 -0.693620340834774 1.65681731809043 1.72643027343785 1.98027005733517 -0.270792840207123 -0.220536506940372 -0.693620340834774 -0.693620340834774 -0.693620340834774 -0.693620340834774 -0.693620340834774 -0.693620340834774 -0.693620340834774 1.73974189544212 1.7259422551493 2.04522469511636 -0.0496816678632112 -0.048451254330504 -0.693620340834774 -0.693620340834774 -0.693620340834774 -0.693620340834774 -0.693620340834774 " 
              rice_harvesting_proportion <- "1.39518021807135 1.39518021807135 1.39518021807135 0.0791443646227185 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 0.901227765519708 1.2996143390774 1.17672685880149 0.94925576698438 0.0798719814979042 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 1.11756172005226 1.09369773457727 1.02409402086324 1.18108707609723 1.17089009160908 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 1.29321873598917 1.28349132192647 1.28583431497897 1.29236442834464 1.27409159661185 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 0.970711731860549 1.39518021807135 1.39518021807135 1.39518021807135 1.33398540043502 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 -0.816375165038537 1.39518021807135 " 
              covariateCollection <- tibble(
                wind_speed = self$strToNum(wind_speed),
                relat_humid_percent_variable_name = self$strToNum(relat_humid_percent_variable_name),
                pre_mm_day_variable_name = self$strToNum(pre_mm_day_variable_name),
                evi_variable_name = self$strToNum(evi_variable_name),
                temp_celsius_variable_name = self$strToNum(temp_celsius_variable_name),
                long_wave_radiation = self$strToNum(long_wave_radiation),
                peanut_planting_proportion = self$strToNum(peanut_planting_proportion),
                rice_harvesting_proportion = self$strToNum(rice_harvesting_proportion)
              )
              return(covariateCollection)
            }
            
          )
  )
